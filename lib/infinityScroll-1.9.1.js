(()=>{var t={757:(t,e,n)=>{t.exports=n(666)},666:t=>{var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof p?e:p,s=Object.create(i.prototype),a=new T(r||[]);return s._invoke=function(t,e,n){var r=u;return function(i,s){if(r===f)throw new Error("Generator is already running");if(r===g){if("throw"===i)throw s;return R()}for(n.method=i,n.arg=s;;){var a=n.delegate;if(a){var o=I(a,n);if(o){if(o===m)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===u)throw r=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var c=h(t,e,n);if("normal"===c.type){if(r=n.done?g:d,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=g,n.method="throw",n.arg=c.arg)}}}(t,n,a),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var u="suspendedStart",d="suspendedYield",f="executing",g="completed",m={};function p(){}function v(){}function x(){}var y={};y[s]=function(){return this};var L=Object.getPrototypeOf,b=L&&L(L(O([])));b&&b!==n&&r.call(b,s)&&(y=b);var k=x.prototype=p.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(i,s,a,o){var c=h(t[i],t,s);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==typeof u&&r.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,a,o)}),(function(t){n("throw",t,a,o)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,o)}))}o(c.arg)}var i;this._invoke=function(t,r){function s(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(s,s):s()}}function I(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,I(t,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=h(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var s=i.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function O(t){if(t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:R}}function R(){return{value:e,done:!0}}return v.prototype=k.constructor=x,x.constructor=v,v.displayName=c(x,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,c(t,o,"GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},w(P.prototype),P.prototype[a]=function(){return this},t.AsyncIterator=P,t.async=function(e,n,r,i,s){void 0===s&&(s=Promise);var a=new P(l(e,n,r,i),s);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(k),c(k,o,"Generator"),k[s]=function(){return this},k.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=O,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return o.type="throw",o.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],o=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=t,a.arg=e,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:O(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}},e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var r={};(()=>{"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function e(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}function i(n){return function(e){if(Array.isArray(e))return t(e)}(n)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(n)||e(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,s=t}finally{try{r||null==o.return||o.return()}finally{if(i)throw s}}return n}}(t,n)||e(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e,n,r,i,s,a){try{var o=t[s](a),c=o.value}catch(t){return void n(t)}o.done?e(c):Promise.resolve(c).then(r,i)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var s=t.apply(e,n);function o(t){a(s,r,i,o,c,"next",t)}function c(t){a(s,r,i,o,c,"throw",t)}o(void 0)}))}}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(r,{InfinityScroll:()=>F});var d=n(757),f=n.n(d),g=function(){function t(e){c(this,t),u(this,"halfOfExistingSizeInDOM",void 0),u(this,"lastRenderIndex",void 0),u(this,"lastPageLastRenderIndex",void 0),u(this,"listLength",void 0),u(this,"listlastPageLength",void 0),u(this,"chunkAmount",void 0),u(this,"tailingElementsAmount",void 0),this.halfOfExistingSizeInDOM=e.halfOfExistingSizeInDOM,this.lastRenderIndex=e.lastRenderIndex,this.lastPageLastRenderIndex=e.lastPageLastRenderIndex,this.listLength=e.listLength,this.listlastPageLength=e.listlastPageLength,this.chunkAmount=e.chunkAmount,this.tailingElementsAmount=e.tailingElementsAmount}return h(t,[{key:"reInitValues",value:function(t,e,n){this.lastRenderIndex=t,this.listLength=e,this.tailingElementsAmount=n}},{key:"isBeginOfListFromTop",value:function(t){return t<=this.chunkAmount}},{key:"isEndOfListFromTop",value:function(t){return t>=this.lastRenderIndex}},{key:"isEndOfListLastPageFromTop",value:function(t){return t>=this.lastPageLastRenderIndex}},{key:"isBeginOfListFromBottom",value:function(t){return 0===t||t<0}},{key:"isEndOfListFromBottom",value:function(t){return t>=this.listLength-3*this.chunkAmount}},{key:"isEndOfListLastPageFromBottom",value:function(t){return t>=this.listlastPageLength-3*this.chunkAmount}},{key:"isAllowRenderNearBorder",value:function(t,e,n){return("down"!==t||!this.isBeginOfListFromTop(e))&&(("down"!==t||!this.isEndOfListFromTop(e))&&(("down"!==t||!n||!this.isEndOfListLastPageFromTop(e))&&("up"!==t||!(this.isBeginOfListFromBottom(e)||this.isEndOfListFromBottom(e)||n&&this.isEndOfListLastPageFromBottom(e)))))}}]),t}(),m=function(){function t(){c(this,t),u(this,"direction","down"),u(this,"isGoingFromBottom",!1),u(this,"maxScroll",0),u(this,"lastPageMaxScroll",0),u(this,"prevScroll",0)}return h(t,[{key:"setScrollDirection",value:function(t,e,n){t!==this.prevScroll&&(e||(t>this.prevScroll?this.direction="down":this.direction="up"),this.prevScroll=t)}},{key:"setGoingFromBottom",value:function(t,e,n,r,i){"down"===this.direction&&n<=1?this.isGoingFromBottom=!1:n>=e-3&&(this.isGoingFromBottom=!0),!this.isGoingFromBottom&&r>=i&&(this.isGoingFromBottom=!0)}},{key:"isBigDiff",value:function(t,e,n){var r=this.isGoingFromBottom&&t>e+n||!this.isGoingFromBottom&&t>e;return r}}]),t}(),p=function(){function t(){c(this,t),u(this,"amount",2),u(this,"htmlHeight",0),u(this,"firstOrderNumber",0),u(this,"lastOrderNumber",1),u(this,"lastPageLastOrderNumber",1),u(this,"lastRenderIndex",0),u(this,"lastPageLastRenderIndex",0),u(this,"startRenderIndex",0),u(this,"itemIndex",0),u(this,"prevPageRenderIndex",0)}return h(t,[{key:"getOrderNumber",value:function(t){return Math.floor(t/this.htmlHeight)}},{key:"getRenderIndexDiff",value:function(t){return Math.abs(this.itemIndex-t)}},{key:"calcRenderIndex",value:function(t){return t*this.amount}},{key:"setRenderIndex",value:function(t,e,n,r){r&&t>this.lastPageLastRenderIndex?this.startRenderIndex=this.lastPageLastRenderIndex:t>this.lastRenderIndex?this.startRenderIndex=this.lastRenderIndex:this.startRenderIndex=t,this.itemIndex=n*(e-1)+this.startRenderIndex}}]),t}(),v=function(){function t(){c(this,t),u(this,"data",void 0),u(this,"fullLength",0),u(this,"length",0),u(this,"lastPageLength",0),u(this,"existingSizeInDOM",0),u(this,"halfOfExistingSizeInDOM",0),u(this,"wrapperHeight",0),u(this,"itemHeight",0),u(this,"tailingElementsAmount",0),u(this,"pageTailingElementsAmount",0),u(this,"lastPageTailingElementsAmount",0),u(this,"startIndexOfLastPart",0),u(this,"lastPageStartIndexOfLastPart",0),this.data=[]}return h(t,[{key:"getTotalListHeight",value:function(){return this.itemHeight*this.fullLength}},{key:"setState",value:function(t){this.tailingElementsAmount=t?this.lastPageTailingElementsAmount:this.pageTailingElementsAmount}}]),t}();function x(t){return Object.keys(t).some((function(e){return!t[e]&&0!==t[e]}))}function y(t){return fetch(t).then((function(t){return t.json().then((function(t){return t})).catch((function(t){}))})).catch((function(){return[]}))}function L(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n-e,i=t({start:e,end:n,limit:r});return y(i)}function b(t,e){return k.apply(this,arguments)}function k(){return(k=o(f().mark((function t(e,n){var r,i;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L(e,1,2);case 2:if(r=t.sent,2!==(null==(i=Array.isArray(r)?r:n&&r[n])?void 0:i.length)){t.next=6;break}return t.abrupt("return",!0);case 6:if(1!==(null==i?void 0:i.length)){t.next=8;break}return t.abrupt("return",!1);case 8:throw new Error("Can't define include end of range");case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function w(t,e,n){return P.apply(this,arguments)}function P(){return(P=o(f().mark((function t(e,n,r){var i,s,a,o,c;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Number(!n),t.next=3,L(e,0,i);case 3:return s=t.sent,t.next=6,L(e,1,1+i);case 6:if(a=t.sent,o=Array.isArray(s)?s:r&&s[r],c=Array.isArray(a)?a:r&&a[r],1!==(null==o?void 0:o.length)){t.next=11;break}return t.abrupt("return",0);case 11:if(1!==(null==c?void 0:c.length)){t.next=13;break}return t.abrupt("return",1);case 13:throw new Error("Can't define base index");case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(t){try{var e=new URL(t);return"http:"===e.protocol||"https:"===e.protocol}catch(t){return!1}}function E(t){return["string"==typeof t&&I(t),"function"==typeof t&&I(t({start:1,end:2}))]}function S(t,e){return T.apply(this,arguments)}function T(){return(T=o(f().mark((function t(e,n){var r,i,s,a,o,c,l,h,u,d,g,m,p,v;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=4,i=!1,s=1,a=0;case 4:if(i){t.next=14;break}return c=s,l=s+r,t.next=9,L(e,c,l);case 9:h=t.sent,(u=Array.isArray(h)?h:n&&h[n])&&u.length>0?(a=s,s*=10):i=!0,t.next=4;break;case 14:o=s,d=!1,g=0;case 17:if(!(g<100)||d){t.next=30;break}return m=Math.ceil((a+o)/2),t.next=23,L(e,m,m+r);case 23:p=t.sent,(v=Array.isArray(p)?p:n&&p[n])&&v.length>0?a=m:o=m,g++,a+1===o&&(d=!0),t.next=17;break;case 30:return t.abrupt("return",a);case 31:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var O=function(){function t(e){c(this,t),u(this,"isStopRender",!1),u(this,"delay",0),u(this,"fillListTimerId",void 0),u(this,"targetElem",void 0),u(this,"targetElemSavedOffset",0),u(this,"template",void 0),u(this,"GLOBAL_ITEM_COUNTER",0),u(this,"skeleton",void 0),u(this,"offsetElem",void 0),this.skeleton=e.skeleton,this.targetElem=e.targetElem,this.template=e.template,this.offsetElem=null}return h(t,[{key:"setPaddingToList",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.length;n&&1!==n.currentPage&&n.currentPage===n.totalPages&&(i=t.lastPageLength);var s=i*t.itemHeight-r;this.targetElem.style.height="".concat(s,"px")}},{key:"calcStartOffsetIndex",value:function(t,e,n,r,i){var s=t-e;return s<0&&(s=0),i.currentPage===i.totalPages&&s>r.lastPageStartIndexOfLastPart?s=r.lastPageStartIndexOfLastPart:s>r.startIndexOfLastPart&&(s=r.startIndexOfLastPart),s}},{key:"setOffsetToList",value:function(t,e,n,r,i){var s=this.calcStartOffsetIndex(e,t.amount,r,n,i)*n.itemHeight;this.offsetElem.style.height="".concat(s,"px"),this.setPaddingToList(n,t.htmlHeight,i,s)}},{key:"createItem",value:function(t,e){return this.skeleton.createElement({data:t,dataIndex:e+1})}},{key:"removeItem",value:function(t){var e=this.targetElem[t];e&&this.targetElem.removeChild(e)}},{key:"fillList",value:function(t){if(!(this.GLOBAL_ITEM_COUNTER>49999||this.GLOBAL_ITEM_COUNTER>=t.length||this.GLOBAL_ITEM_COUNTER>=t.existingSizeInDOM)){for(var e=document.createDocumentFragment(),n=0;n<1e3&&n<t.length&&this.GLOBAL_ITEM_COUNTER<t.length&&this.GLOBAL_ITEM_COUNTER<t.existingSizeInDOM;n++){if(void 0===t.data)throw new Error("Your list.data is undefined");var r=t.data[this.GLOBAL_ITEM_COUNTER];e.append(this.createItem(r,this.GLOBAL_ITEM_COUNTER)),this.GLOBAL_ITEM_COUNTER++}this.targetElem.append(e)}}},{key:"calcSequenceByDirection",value:function(t,e,n,r){var i="down"===t?n+e:n-r;return i<0&&(i=0),i}},{key:"resetAllList",value:function(t,e,n,r,i,s){var a=document.createDocumentFragment(),o=r.existingSizeInDOM;1!==s.currentPage&&s.currentPage===s.totalPages&&r.lastPageLength<r.existingSizeInDOM&&(o=r.lastPageLength);for(var c=0;c<1e3&&c<o;c++){var l=c+n;if(void 0===r.data)throw new Error("Your list.data is undefined");var h=r.data[l];a.append(this.createItem(h,l))}this.targetElem.innerHTML="",this.targetElem.append(a),this.setOffsetToList(t,e,r,i,s)}},{key:"checkAllowToChangeList",value:function(t,e,n,r,i,s){var a="up"===t&&0===e,o=s.isLastPage?i.lastPageTailingElementsAmount:i.pageTailingElementsAmount,c=n&&a&&0!==o&&r+e>=o,l=!1;return"down"===t&&r+e>=i.length&&(l=!0),"down"===t&&1!==s.currentPage&&s.currentPage===s.totalPages&&r+e>=i.lastPageLength&&(l=!0),!c&&!l}},{key:"prepareItems",value:function(t,e,n,r,i,s,a,o){for(var c=document.createDocumentFragment(),l=0;l<1e3&&l<t;l++){if(this.checkAllowToChangeList(e,n,r,l,i,s)){var h=l+o,u=i.data[h];c.append(this.createItem(u,h)),this.removeItem(a)}}return c}},{key:"putElementsToList",value:function(t,e){"down"===t?this.targetElem.append(e):this.targetElem.prepend(e)}},{key:"changeItemsInList",value:function(t,e,n,r,i){var s="down"===n?"firstChild":"lastChild",a=this.calcSequenceByDirection(n,e.halfOfExistingSizeInDOM,t.startRenderIndex,t.amount),o=(i.currentPage-1)*e.length+a;if(void 0===e.data)throw new Error("Your list.data is undefined");var c=this.prepareItems(t.amount,n,a,r,e,i,s,o);this.putElementsToList(n,c)}},{key:"modifyCurrentDOM",value:function(t,e,n,r,i){this.changeItemsInList(t,e,n,r,i),this.setOffsetToList(t,t.startRenderIndex,e,n,i)}}]),t}();function R(t){var e=document.createElement("table");return e.innerHTML="<tbody>".concat(t,"</tbody>"),e.firstElementChild.firstElementChild}function D(t){var e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}function A(t){t.classList.add("loading"),t.innerHTML=t.innerHTML.replaceAll("undefined","Loading")}function M(t){t.classList.add("loading"),t.innerHTML='<td colspan="2">Loading<span class="dots">...</span></td>'}var N=function(){function t(e){c(this,t),u(this,"template",void 0),u(this,"templateCb",void 0),u(this,"listLength",void 0),u(this,"makeItemFromString",void 0),u(this,"setLoadingPlaceholder",void 0),this.template=e.template,this.templateCb=e.templateCb,this.makeItemFromString="table"!==e.listType?D:R,this.setLoadingPlaceholder="table"!==e.listType?A:M}return h(t,[{key:"setListHeight",value:function(t){this.listLength=t}},{key:"setRequiredAttrs",value:function(t){var e=t.element,n=t.dataIndex;e.setAttribute("aria-setsize",this.listLength.toString()),e.setAttribute("aria-posinset",n.toString())}},{key:"updateElement",value:function(t,e,n){var r=this.template({item:e,listLength:this.listLength,idx:n,templateCb:this.templateCb}),i=this.makeItemFromString(r);this.setRequiredAttrs({element:i,dataIndex:n}),t.replaceWith(i)}},{key:"createElement",value:function(t){var e=t.data,n=t.dataIndex,r=this.template({item:e||{},listLength:this.listLength,idx:n,templateCb:this.templateCb}),i=this.makeItemFromString(r);return e||this.setLoadingPlaceholder(i),this.setRequiredAttrs({element:i,dataIndex:n}),i}}]),t}(),H=function(){function t(e,n){c(this,t),u(this,"elem",void 0),u(this,"origScrollElem",void 0),u(this,"currentPage",void 0),u(this,"totalPages",void 0),u(this,"fillerHeight",void 0),u(this,"scroll",void 0),u(this,"safeLimit",void 0),u(this,"scrollPercent",void 0),u(this,"sizeOfPercentByOnePage",void 0),u(this,"sizeOfPercentByLastPage",0),u(this,"sizeOfScrollByOnePage",void 0),u(this,"sizeOfScrollByLastPage",0),u(this,"isPageChanged",!1),u(this,"isLastPage",!1),u(this,"scrollRatio",void 0),u(this,"setHeight",void 0),this.currentPage=1,this.totalPages=1,this.fillerHeight=1,this.scroll=1,this.safeLimit=111e3,this.scrollPercent=0,this.sizeOfPercentByOnePage=1,this.sizeOfScrollByOnePage=1,this.scrollRatio=1,this.elem=document.createElement("div"),this.elem.classList.add("vSrcollbar"),e&&this.elem.classList.add("vSrcollbar_debugMode"),this.elem.addEventListener("scroll",n)}return h(t,[{key:"init",value:function(t){var e=t.totalHeight,n=t.realHeight,r=t.fullLength,i=t.listLength,s=t.lastPageLength,a=t.origScrollElem;this.origScrollElem=a,this.createFiller(n),this.countTotalPages(r,i,e),this.setScrollRatio(r,i,s),this.sizeOfPercentByOnePage=1/this.totalPages*this.scrollRatio,this.sizeOfScrollByOnePage=this.fillerHeight/this.totalPages*this.scrollRatio}},{key:"createFiller",value:function(t){var e,n,r=document.createElement("div");r.classList.add("vScrollbarFiller"),r.style.height="".concat(t,"px"),this.fillerHeight=t-(null===(e=this.origScrollElem)||void 0===e?void 0:e.clientHeight),null===(n=this.origScrollElem)||void 0===n||n.clientHeight,this.elem.append(r)}},{key:"countTotalPages",value:function(t,e,n){new Intl.NumberFormat("ru-RU").format(n),new Intl.NumberFormat("ru-RU").format(33554400),new Intl.NumberFormat("ru-RU").format(this.safeLimit);this.totalPages=Math.ceil(n/this.safeLimit),this.totalPages;var r=e;r>t&&(r=t);var i=t%r,s=(t-i)/r+(0===i?0:1);this.totalPages;var a=s===this.totalPages;return a||console.warn("controlCheck не пройден!!!"),this.totalPages=s,s}},{key:"handleScroll",value:function(){this.scroll=this.elem.scrollTop,this.syncScrollState()}},{key:"setScrollFromOuterSrc",value:function(t,e){var n=this.sizeOfScrollByOnePage*(this.currentPage-1)+t*this.scrollRatio/this.totalPages,r=!1;if("down"===e&&t>=this.fillerHeight&&this.currentPage<this.totalPages?(r=!0,this.currentPage++):"up"===e&&t<=1&&this.currentPage>1&&(r=!0,this.currentPage--),this.scroll=n,this.elem.scrollTop=this.scroll,this.isLastPage=this.currentPage===this.totalPages,r){this.setScrollPercent(),this.isPageChanged=!0;var i="up"===e&&this.currentPage===this.totalPages-1;this.setHeight&&i&&this.setHeight(),this.setScrollToOrigScrollElem(e,r)}}},{key:"syncScrollState",value:function(t){this.setScrollPercent(),this.setCurrentPage(),this.setScrollToOrigScrollElem(t)}},{key:"setCurrentPage",value:function(){var t=this.getPageByScroll();this.isPageChanged=this.currentPage!==t,this.currentPage=t,this.isLastPage=this.currentPage===this.totalPages}},{key:"setScrollToOrigScrollElem",value:function(t,e){if(e)this.origScrollElem.scrollTop="down"===t?1:this.fillerHeight-1;else{var n=(this.currentPage-1)*this.sizeOfPercentByOnePage,r=(this.scrollPercent-n)*this.totalPages,i=this.fillerHeight*r/this.scrollRatio;this.origScrollElem.scrollTop=i}}},{key:"setScrollPercent",value:function(){this.scrollPercent=this.scroll/this.fillerHeight}},{key:"getPageByScroll",value:function(){var t=this.scrollPercent*this.totalPages/this.scrollRatio;return Math.ceil(t)||1}},{key:"setScrollRatio",value:function(t,e,n){var r=e*this.totalPages,i=t;this.scrollRatio=r/i,this.scrollRatio}}]),t}(),C=function(){function t(e){c(this,t),u(this,"storeName",void 0),this.storeName=e}var e,n,r,i,s,a,l,d,g,m,p;return h(t,[{key:"openDatabase",value:(p=o(f().mark((function e(n){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var i=indexedDB.open(t.DB_NAME);i.onupgradeneeded=function(){var e=i.result;e.objectStoreNames.contains(t.TTL_STORE)||e.createObjectStore(t.TTL_STORE,{keyPath:"storeName"}),e.objectStoreNames.contains(n)||e.createObjectStore(n)},i.onsuccess=function(){var s=i.result;if(s.objectStoreNames.contains(n))e(s);else{s.close();var a=indexedDB.open(t.DB_NAME,s.version+1);a.onupgradeneeded=function(){a.result.createObjectStore(n)},a.onsuccess=function(){return e(a.result)},a.onerror=function(){return r(a.error)}}},i.onerror=function(){return r(i.error)}})));case 1:case"end":return e.stop()}}),e)}))),function(t){return p.apply(this,arguments)})},{key:"setTTL",value:(m=o(f().mark((function e(n){var r,i,s,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.openDatabase(t.TTL_STORE);case 2:return r=e.sent,i=r.transaction(t.TTL_STORE,"readwrite"),s=i.objectStore(t.TTL_STORE),a={storeName:this.storeName,createdAt:Date.now(),ttlMs:n},s.put(a),e.abrupt("return",new Promise((function(t){i.oncomplete=function(){r.close(),t()}})));case 8:case"end":return e.stop()}}),e,this)}))),function(t){return m.apply(this,arguments)})},{key:"isExpired",value:(g=o(f().mark((function e(){var n,r,i,s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.openDatabase(t.TTL_STORE);case 2:return n=e.sent,r=n.transaction(t.TTL_STORE,"readonly"),i=r.objectStore(t.TTL_STORE),s=i.get(this.storeName),e.abrupt("return",new Promise((function(t){s.onsuccess=function(){n.close();var e=s.result;if(!e)return t(!1);t(Date.now()>e.createdAt+e.ttlMs)},s.onerror=function(){n.close(),t(!1)}})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"clearIfExpired",value:(d=o(f().mark((function t(){var e,n;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.isExpired();case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:return console.warn("Your data in store '".concat(this.storeName,"' is expired!")),t.next=8,this.openDatabase(this.storeName);case 8:return e=t.sent,(n=e.transaction(this.storeName,"readwrite")).objectStore(this.storeName).clear(),t.abrupt("return",new Promise((function(t){n.oncomplete=function(){e.close(),t()}})));case 12:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"write",value:(l=o(f().mark((function t(e,n){var r,i;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openDatabase(this.storeName);case 2:return r=t.sent,(i=r.transaction(this.storeName,"readwrite")).objectStore(this.storeName).put(n,e),t.abrupt("return",new Promise((function(t,e){i.oncomplete=function(){r.close(),t()},i.onerror=function(){r.close(),e(i.error)}})));case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return l.apply(this,arguments)})},{key:"writeMany",value:(a=o(f().mark((function t(e){var n,r,i;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openDatabase(this.storeName);case 2:return n=t.sent,r=n.transaction(this.storeName,"readwrite"),i=r.objectStore(this.storeName),e.forEach((function(t){var e=t.value,n=t.index;if(!("id"in e))throw new Error('All objects must contain an "id" property to be used as the key.');i.put(e,n)})),t.abrupt("return",new Promise((function(t,e){r.oncomplete=function(){n.close(),t()},r.onerror=function(){n.close(),e(r.error)}})));case 7:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"readAll",value:(s=o(f().mark((function t(){var e,n,r,i;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.clearIfExpired();case 2:return t.next=4,this.openDatabase(this.storeName);case 4:return e=t.sent,n=e.transaction(this.storeName,"readonly"),r=n.objectStore(this.storeName),i=[],t.abrupt("return",new Promise((function(t,n){var s=r.openCursor();s.onsuccess=function(){var n=s.result;if(n){var r=n.key;i[r]=n.value,n.continue()}else e.close(),t(i)},s.onerror=function(){e.close(),n(s.error)}})));case 9:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"readRange",value:(i=o(f().mark((function t(e,n){var r,i,s,a,o;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.clearIfExpired();case 2:return t.next=4,this.openDatabase(this.storeName);case 4:return r=t.sent,i=r.transaction(this.storeName,"readonly"),s=i.objectStore(this.storeName),a=IDBKeyRange.bound(e,n),o=new Array(n-e+1),t.abrupt("return",new Promise((function(t,n){var i=s.openCursor(a);i.onsuccess=function(){var n=i.result;if(n){var s=n.key;o[s-e]=n.value,n.continue()}else r.close(),t(o)},i.onerror=function(){r.close(),n(i.error)}})));case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"get",value:(r=o(f().mark((function t(e){var n,r,i;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.clearIfExpired(this.storeName);case 2:return t.next=4,this.openDatabase(this.storeName);case 4:return n=t.sent,r=n.transaction(this.storeName,"readonly"),i=r.objectStore(this.storeName),t.abrupt("return",new Promise((function(t,r){var s=i.get(e);s.onsuccess=function(){n.close(),t(s.result)},s.onerror=function(){n.close(),r(s.error)}})));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"has",value:(n=o(f().mark((function t(e){var n,r,i;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openDatabase(this.storeName);case 2:return n=t.sent,r=n.transaction(this.storeName,"readonly"),i=r.objectStore(this.storeName),t.abrupt("return",new Promise((function(t){var r=i.count(e);r.onsuccess=function(){n.close(),t(r.result>0)},r.onerror=function(){n.close(),t(!1)}})));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"getStoreSize",value:(e=o(f().mark((function t(){var e,n,r;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openDatabase(this.storeName);case 2:return e=t.sent,n=e.transaction(this.storeName,"readonly"),r=n.objectStore(this.storeName),t.abrupt("return",new Promise((function(t,n){var i=r.count();i.onsuccess=function(){e.close(),t(i.result)},i.onerror=function(){e.close(),n(i.error)}})));case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}();u(C,"DB_NAME","iScrollDB"),u(C,"TTL_STORE","__ttl__");function z(){var t=this;this.tests.name="",this.tests.errors.clear();var e=this.vsb,n=e.fillerHeight,r=e.elem,i=Math.ceil(n/33),s=this.chunk.htmlHeight,a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(e){setTimeout((function(){return e()}),t)}))},c=function(){return new Promise((function(e){for(var n=0;n<33;n++)setTimeout((function(){t.vsb.elem.scrollTop-=i}),10*n);setTimeout((function(){return e()}),360)}))},l=function(){return new Promise((function(e){for(var n=0;n<33;n++)setTimeout((function(){t.vsb.elem.scrollTop+=i}),10*n);setTimeout((function(){return e()}),360)}))},h=function(t){return new Promise((function(e){r.scrollTop=t,setTimeout(e,0)}))},u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise((function(n){setTimeout(o(f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t);case 2:n();case 3:case"end":return e.stop()}}),e)}))),e)}))},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return u(0,t)},g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return u(n,t)},m=function(){return h(0)},p=function(){return h(n)};function v(){return x.apply(this,arguments)}function x(){return(x=o(f().mark((function t(){var e,n,r,i=arguments;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=i.length>0&&void 0!==i[0]?i[0]:3,n=function(t){setTimeout((function(){"%c ".concat(t,"! ")}),1e3*(e-t))},r=e;r>0;r--)n(r);return t.abrupt("return",new Promise((function(t){setTimeout(t,1e3*e)})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function y(){return L.apply(this,arguments)}function L(){return(L=o(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,m();case 3:return t.next=5,l();case 5:return t.next=7,c();case 7:return t.abrupt("return",Promise.resolve());case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function b(){var t=Array.from(this.tests.errors).reduce((function(t,e){return t+e[1].length}),0);0!==this.tests.errors.size&&("%c Тестов не пройдено: ".concat(this.tests.errors.size," <----"),"%c Ошибок обнаружено: ".concat(t," <----"),this.tests.errors.forEach((function(t,e){var n=t;"%c Тест: ".concat(e),n.forEach((function(t,e){}))})))}console.clear();var k=function(t,e){var n=this;return function(){var r=o(f().mark((function r(){var i,s,o=arguments;return f().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=o.length>0&&void 0!==o[0]?o[0]:3,s=!(o.length>1&&void 0!==o[1])||o[1],n.tests.name=t,r.next=5,v(i);case 5:return"%c --- start  fn: ".concat(t,"  --- "),r.next=8,e();case 8:return"%c --- end  fn: ".concat(t,"  --- "),r.next=11,a(200);case 11:if(!s){r.next=14;break}return r.next=14,y();case 14:n.tests.name="","%c --- END TEST: ".concat(t,"  --- ");case 16:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()}.bind(this),w=k("LocalSimple100item",o(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u(3050,1e3);case 2:return t.next=4,u(2750,200);case 4:return t.next=6,d(50);case 6:return t.next=8,u(1.5*s,500);case 8:case"end":return t.stop()}}),t)})))),P=k("RemoteSimple500item",o(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l();case 2:return t.next=4,c();case 4:case"end":return t.stop()}}),t)})))),I=k("testRemoteLazyDummyjsonAPI",o(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h(900);case 2:return t.next=4,p();case 4:return t.next=6,u(0,300);case 6:return t.next=8,u(1.5*s,300);case 8:return t.next=10,u(n-1.5*s,300);case 10:return t.next=12,u(3*s,300);case 12:return t.next=14,h(s/2);case 14:return t.next=16,l();case 16:return t.next=18,m();case 18:return t.next=20,h(n/2);case 20:return t.next=22,l();case 22:return t.next=24,h(n/2);case 24:return t.next=26,c();case 26:return console.warn("-------------------"),t.next=29,h(900);case 29:return t.next=31,p();case 31:return t.next=33,u(0,300);case 33:return c(),t.next=36,u(1.5*s,300);case 36:return t.next=38,u(n-1.5*s,300);case 38:return t.next=40,l().then(o(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u(3*s,400),u(5*s,800),u(s,1200),h(s/2),t.next=6,c();case 6:return t.next=8,l();case 8:return t.next=10,c();case 10:return t.next=12,l();case 12:return t.next=14,c();case 14:return t.next=16,l();case 16:return t.next=18,c();case 18:return t.next=20,l();case 20:return t.next=22,c();case 22:case"end":return t.stop()}}),t)}))));case 40:return t.next=42,l();case 42:return h(n/2),u(n/2,1200),t.next=46,l();case 46:return h(n/2),t.next=49,c();case 49:case"end":return t.stop()}}),t)})))),E=k("smoothUpDownScrollDomTest",o(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l();case 2:return t.next=4,c();case 4:return t.next=6,l();case 6:return t.next=8,c();case 8:return t.next=10,l();case 10:return t.next=12,c();case 12:return t.next=14,l();case 14:return t.next=16,c();case 16:return t.next=18,l();case 18:return t.next=20,c();case 20:case"end":return t.stop()}}),t)})))),S=k("fastUpDownScrollDomTest",o(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g();case 2:return t.next=4,d(150);case 4:return t.next=6,g(150);case 6:return t.next=8,d(150);case 8:return t.next=10,g(150);case 10:return t.next=12,d(150);case 12:return t.next=14,g(150);case 14:return t.next=16,d(150);case 16:return t.next=18,g(150);case 18:return t.next=20,d(150);case 20:return t.next=22,g(150);case 22:return t.next=24,d(150);case 24:case"end":return t.stop()}}),t)})))),T=k("chaoticScrollDomTest",o(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h(900);case 2:return t.next=4,p();case 4:return t.next=6,u(0,300);case 6:return t.next=8,u(1.5*s,300);case 8:return t.next=10,u(n-1.5*s,300);case 10:return t.next=12,u(3*s,300);case 12:return t.next=14,h(s/2);case 14:return t.next=16,l();case 16:return t.next=18,m();case 18:return t.next=20,h(n/2);case 20:return t.next=22,l();case 22:return t.next=24,h(n/2);case 24:return t.next=26,c();case 26:case"end":return t.stop()}}),t)})))),O=k("asyncChaoticScrollDomTest",o(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h(900);case 2:return t.next=4,p();case 4:return t.next=6,u(0,300);case 6:return c(),t.next=9,u(1.5*s,300);case 9:return t.next=11,u(n-1.5*s,300);case 11:return t.next=13,l().then(o(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u(3*s,400),u(5*s,800),u(s,1200),h(s/2),t.next=6,c();case 6:return t.next=8,l();case 8:return t.next=10,c();case 10:return t.next=12,l();case 12:return t.next=14,c();case 14:return t.next=16,l();case 16:return t.next=18,c();case 18:return t.next=20,l();case 20:return t.next=22,c();case 22:case"end":return t.stop()}}),t)}))));case 13:return t.next=15,l();case 15:return h(n/2),u(n/2,1200),t.next=19,l();case 19:return h(n/2),t.next=22,c();case 22:case"end":return t.stop()}}),t)})))),R=!1;o(f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(1,R);case 2:return e.next=4,T(1,R);case 4:return e.next=6,O(1,R);case 6:return e.next=8,E(1,R);case 8:return e.next=10,w(1,R);case 10:return e.next=12,I(1,R);case 12:return e.next=15,P(1);case 15:b.call(t);case 16:case"end":return e.stop()}}),e)})))(),setTimeout((function(){}),500),setTimeout((function(){}),1e3),setTimeout((function(){}),1200)}function B(t,e,n,r){var i="down"===t?n+e:n-r;return i<0&&(i=0),i}var _={list:"UL",table:"TABLE",div:"DIV"},U={en:{zeroHeight:"Your list height is less than 10px. You need to set your list-height from STYLES (by css) or pass like property in JS",elementNotExist:"This element does not exist in DOM",undefinedProps:"Some of props for RenderController is undefined",domManagerIsUndefined:"Your DomManager is undefined",renderControllerIsUndefined:"RenderController (this.render) is not exist",dataIsUndefined:"You does not have list.data",notValidUrl:"Your dataUrl is not a valid URL; or returned value is not a  valid URL",notArray:"Your list does not have Array type",zeroListSize:"Your list does not have length or length is 0",noTargetElem:"You do not have HTML-element for your list",noDataUrl:"You try to call getListDataLazy, but you dont have dataUrl",dataUrlNotAFn:"You try to call getListDataLazy, but your dataUrl is a string type",fetchedIsNotArray:"Your fetched data does not have Array type"},ru:{zeroHeight:"Высота вашего списка меньше чем 10px. Вам нужно установить высоту вашего списка из СТИЛЕЙ (через CSS) или передавать как свойство в JS",elementNotExist:"Такого элемента не существует в DOM",undefinedProps:"Некоторые свойства для RenderController не определены",domManagerIsUndefined:"Ваш DomManager не определён",renderControllerIsUndefined:"RenderController (this.render) не существует",dataIsUndefined:"У вас отсутствует list.data",notValidUrl:"Ваш dataUrl не является правильной URL-ссылкой или возвращает неправильную ссылку (исправьте dataUrl в свойствах при запуске InfinityScroll)",notArray:"Ваш список не является массивом (Array). Проверьте, что вы передаёте внутрь InfinityScroll",zeroListSize:"Ваш список пуст или его размер равен 0",noTargetElem:"Вы не указали HTML-элемент для вашего списка",noDataUrl:"Вы пытаетесь вызвать getListDataLazy, но у вас нет dataUrl (ссылки)",dataUrlNotAFn:"Вы пытаетесь вызвать getListDataLazy, но ваш dataUrl является строкой",fetchedIsNotArray:"Ваши загруженные данные не являются Массивом (Array)"}}["ru"===navigator.language.split("-")[0]?"ru":"en"],F=function(){function t(e){var n=this;c(this,t),u(this,"timerIdRefreshList",void 0),u(this,"name",void 0),u(this,"selectorId",void 0),u(this,"wrapperEl",void 0),u(this,"middleWrapper",void 0),u(this,"subDir",void 0),u(this,"forcedListLength",void 0),u(this,"listType",void 0),u(this,"tHeadNames",void 0),u(this,"listWrapperHeight",void 0),u(this,"dataLoadPlace",void 0),u(this,"isLazy",void 0),u(this,"dataUrl",void 0),u(this,"includeEnd",void 0),u(this,"basedIndex",void 0),u(this,"isSyncing",void 0),u(this,"listEl",void 0),u(this,"offsetElem",void 0),u(this,"domMngr",void 0),u(this,"scroll",void 0),u(this,"chunk",void 0),u(this,"list",void 0),u(this,"render",void 0),u(this,"skeleton",void 0),u(this,"vsb",void 0),u(this,"dbmanager",void 0),u(this,"test",void 0),u(this,"tests",void 0),u(this,"isDebugMode",!1),u(this,"sleep",(function(t){return new Promise((function(e){return setTimeout(e,t)}))})),this.selectorId=e.selectorId;var r=document.getElementById(e.selectorId);if(null===r)throw new Error("".concat(e.selectorId," - ").concat(U.elementNotExist));this.wrapperEl=r,this.subDir=e.subDir,this.forcedListLength=e.forcedListLength,this.listType=e.listType||"list",this.tHeadNames=e.tHeadNames,this.listWrapperHeight=e.listWrapperHeight,this.isDebugMode=e.isDebugMode||!1,this.listEl=this.createInnerList(),this.scroll=new m,this.chunk=new p,this.list=new v,this.vsb=new H(this.isDebugMode,(function(){n.isSyncing||(n.isSyncing=!0,n.scroll.setScrollDirection(n.vsb.elem.scrollTop,n.vsb.isPageChanged,n.vsb.isLastPage),n.vsb.handleScroll(),n.calcCurrentDOMRender(),setTimeout((function(){n.vsb.scroll!==n.vsb.elem.scrollTop&&n.vsb.handleScroll(),n.isSyncing=!1}),0))})),this.dbmanager=new C(this.selectorId),this.skeleton=new N({template:e.templateString,templateCb:e.templateCb,listType:this.listType});var i={skeleton:this.skeleton,targetElem:this.listEl,template:e.templateString};this.domMngr=new O(i),this.dataLoadPlace=Array.isArray(e.data)?"local":"remote",this.isLazy=!1,this.includeEnd=!1,this.basedIndex=1,this.isSyncing=!1,e.data,this.test=z,this.tests={name:"",errors:new Map},"remote"===this.dataLoadPlace&&(this.dataUrl=e.data),this.getSavedListData().then((function(t){t.length&&(n.list.data=t)})),this.setInitialListData(e.data).then((function(){n.start()}))}var e,n,r,a,l,d,k,P,I,T;return h(t,[{key:"start",value:(T=o(f().mark((function t(){var e,n,r,i,a=this;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.setDefaultStyles(),this.getAllSizes(),this.offsetElem=document.createElement("div"),this.offsetElem.classList.add("offsetElem"),this.middleWrapper.prepend(this.offsetElem),this.domMngr.offsetElem=this.offsetElem,!this.isLazy){t.next=11;break}return r=this.basedIndex+1,t.next=11,this.getListDataLazy(r,this.list.existingSizeInDOM).then((function(t){var e=new Array(1).concat(t);a.setListData(e)}));case 11:if(this.vsb.setHeight=function(){return a.domMngr.setPaddingToList(a.list,a.chunk.htmlHeight)},this.chunk.lastPageLastRenderIndex=this.list.lastPageLength>this.list.halfOfExistingSizeInDOM?this.list.lastPageLength-this.list.halfOfExistingSizeInDOM:1,!x(i={halfOfExistingSizeInDOM:this.list.halfOfExistingSizeInDOM,lastRenderIndex:this.chunk.lastRenderIndex,lastPageLastRenderIndex:this.chunk.lastPageLastRenderIndex,listLength:this.list.length,listlastPageLength:this.list.lastPageLength,chunkAmount:this.chunk.amount,tailingElementsAmount:this.list.tailingElementsAmount})){t.next=17;break}throw new Error(U.undefinedProps);case 17:this.render=new g(i),this.domMngr.fillList(this.list),this.domMngr.setPaddingToList(this.list,this.chunk.htmlHeight),this.scroll.maxScroll=this.list.length*this.list.itemHeight-(null===(e=this.middleWrapper)||void 0===e?void 0:e.clientHeight),this.scroll.lastPageMaxScroll=this.list.lastPageLength*this.list.itemHeight-(null===(n=this.middleWrapper)||void 0===n?void 0:n.clientHeight),this.createVirtualScroll(),this.middleWrapper.addEventListener("scroll",(function(t){if(!a.isSyncing){if(a.isSyncing=!0,a.scroll.setScrollDirection(a.middleWrapper.scrollTop,a.vsb.isPageChanged,a.vsb.isLastPage),a.vsb.setScrollFromOuterSrc(t.target.scrollTop,a.scroll.direction),a.vsb.isPageChanged){var e=s(a.calcRenderIndex(t.target.scrollTop),1)[0];a.chunk.setRenderIndex(e,a.vsb.currentPage,a.list.length,a.vsb.isLastPage),a.vsb.isLastPage,a.vsb.currentPage,a.refreshList()}else a.calcCurrentDOMRender();setTimeout((function(){a.vsb.isPageChanged=!1,a.isSyncing=!1}),0)}})),this.setIndexedDb();case 25:case"end":return t.stop()}}),t,this)}))),function(){return T.apply(this,arguments)})},{key:"setDefaultStyles",value:function(){if(void 0!==this.listWrapperHeight&&(this.wrapperEl.style.height=this.listWrapperHeight),this.wrapperEl.offsetHeight<10){var t=U.zeroHeight;throw this.wrapperEl.innerHTML="<h3>".concat(t,"</h3>"),new Error(t)}this.wrapperEl.style.position="relative"}},{key:"createInnerList",value:function(){this.middleWrapper=document.createElement("div"),this.middleWrapper.classList.add("middleWrapper"),this.wrapperEl.append(this.middleWrapper);var t=document.createElement(_[this.listType]),e="".concat(this.selectorId,"_").concat(this.listType.charAt(0).toUpperCase()).concat(this.listType.slice(1));if(t.setAttribute("class",e),"table"===this.listType&&this.tHeadNames&&this.tHeadNames.length>0){var n,r=document.createElement("tbody"),i=document.createElement("thead"),s=null===(n=this.tHeadNames)||void 0===n?void 0:n.reduce((function(t,e){return t+"<td>".concat(e,"</td>")}),"");return i.innerHTML='<tr class="'.concat(this.selectorId,'__listItem">').concat(s,"</tr>"),this.middleWrapper.appendChild(t).appendChild(i),this.middleWrapper.appendChild(t).appendChild(r)}return this.middleWrapper.appendChild(t)}},{key:"getAllSizes",value:function(){var t;if(void 0===this.domMngr)throw new Error(U.domManagerIsUndefined);var e=this.wrapperEl,n=this.listEl,r=window.getComputedStyle(e),i=n.firstChild;if(this.list.wrapperHeight=parseInt(r.getPropertyValue("height"),10)||1,this.list.wrapperHeight<2)console.error("You must set height to your list-wrapper more than 10px!");else{if(!i){if(!this.list.data)throw new Error(U.dataIsUndefined);var s=this.list.data[0];this.domMngr.targetElem.append(this.domMngr.createItem(s,0)),i=n.firstChild}var a="".concat(this.selectorId,"_").concat(this.listType.charAt(0).toUpperCase()).concat(this.listType.slice(1)),o={list:"li",table:"tbody > tr",div:"div"}[this.listType],c=".".concat(this.selectorId,"_List {\n      overflow: hidden; \n      margin: 0;\n      }\n      \n.").concat(this.selectorId,"_List li { \n      white-space: nowrap;\n    }\n\n    \n.").concat(a," > ").concat(o).concat(".loading .dots {\n    width: 0.5em;\n    animation: load 3s steps(4, end) infinite;\n    display: inline-block;\n    overflow: hidden;\n    vertical-align: text-bottom;\n}\n\n@keyframes load {\n    from {\n        width: 0em;\n    }\n    to   {\n        width: 2em;\n    }\n}\n"),l=document.createElement("style");l.appendChild(document.createTextNode(c)),this.wrapperEl.prepend(l),this.list.itemHeight=(null===(t=i)||void 0===t?void 0:t.offsetHeight)||this.list.wrapperHeight;var h=document.createElement("style"),u=".".concat(this.selectorId,"_List li.loading { \n      min-height: ").concat(this.list.itemHeight,"px;\n      box-sizing: border-box;\n    }\n    \n.").concat(this.selectorId,"_List li.loading img { \n      width: 100%;\n      aspect-ratio: 1;\n      background: #ccc;\n      animation: opacityLoader 3s ease-in-out infinite alternate;\n      border-radius: 10px;\n    }\n    \n@keyframes opacityLoader {\n    from {\n        opacity: 1;\n    }\n    to   {\n        opacity: 0.1;\n    }\n}\n    ");h.appendChild(document.createTextNode(u)),l.after(h),this.chunk.amount=Math.ceil(this.list.wrapperHeight/this.list.itemHeight),this.list.existingSizeInDOM=4*this.chunk.amount,this.list.halfOfExistingSizeInDOM=this.list.existingSizeInDOM/2,this.list.length=Math.round(this.vsb.safeLimit/this.list.itemHeight),this.list.length>this.list.fullLength&&(this.list.length=this.list.fullLength),(!this.isLazy&&this.list.length>this.list.data.length||this.list.length<=0)&&(this.list.length=this.list.data.length),this.list.lastPageLength=this.list.fullLength%this.list.length,0===this.list.lastPageLength&&(this.list.lastPageLength,this.list.lastPageLength=this.list.length),this.chunk.lastRenderIndex=this.list.length-this.list.halfOfExistingSizeInDOM-this.list.tailingElementsAmount,this.list.startIndexOfLastPart=this.list.length-this.list.existingSizeInDOM,this.chunk.lastOrderNumber=Math.floor(this.list.length/this.chunk.amount),this.chunk.htmlHeight=this.chunk.amount*this.list.itemHeight,i&&this.domMngr.removeItem("firstChild")}}},{key:"createVirtualScroll",value:function(){var t;this.list.tailingElementsAmount=this.list.length%this.chunk.amount,this.list.pageTailingElementsAmount=this.list.length%this.chunk.amount,this.list.lastPageTailingElementsAmount=this.list.lastPageLength%this.chunk.amount,this.list.tailingElementsAmount,this.chunk.prevPageRenderIndex=this.chunk.lastRenderIndex+this.chunk.amount-this.chunk.lastRenderIndex%this.chunk.amount,this.render&&this.render.reInitValues(this.chunk.lastRenderIndex,this.list.length,this.list.tailingElementsAmount),this.domMngr.setPaddingToList(this.list,this.chunk.htmlHeight),this.skeleton.setListHeight(this.list.fullLength),this.list.lastPageStartIndexOfLastPart=this.list.lastPageLength-this.list.existingSizeInDOM,this.list.lastPageStartIndexOfLastPart<0&&(this.list.lastPageStartIndexOfLastPart=0),this.chunk.lastOrderNumber=Math.floor(this.list.length/this.chunk.amount),this.chunk.lastPageLastOrderNumber=Math.floor(this.list.lastPageLength/this.chunk.amount);var e=this.list.getTotalListHeight(),n=this.listEl.offsetHeight;this.vsb.init({totalHeight:e,realHeight:n,fullLength:this.list.fullLength,listLength:this.list.length,lastPageLength:this.list.lastPageLength,origScrollElem:this.middleWrapper}),null===(t=this.middleWrapper)||void 0===t||t.after(this.vsb.elem)}},{key:"calcRenderIndex",value:function(t){var e=this.chunk.getOrderNumber(t);var n=this.chunk.calcRenderIndex(e),r=this.vsb.isLastPage?this.chunk.lastPageLastOrderNumber:this.chunk.lastOrderNumber,i=this.vsb.isLastPage?this.scroll.lastPageMaxScroll:this.scroll.maxScroll;this.scroll.setGoingFromBottom(this.chunk.firstOrderNumber,r,e,t,i);var s=this.vsb.isLastPage?this.list.lastPageTailingElementsAmount:this.list.pageTailingElementsAmount,a=n+(this.scroll.isGoingFromBottom?s:0);return this.chunk.startRenderIndex!==a&&"up"===this.scroll.direction&&a>this.chunk.prevPageRenderIndex&&(a=this.list.length-3*this.chunk.amount),[a,n]}},{key:"calcCurrentDOMRender",value:(I=o(f().mark((function t(){var e,n,r,i,a,o,c,l,h,u,d,g,m,p,v;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.middleWrapper,n=e.scrollTop,r=this.calcRenderIndex(n),i=s(r,2),a=i[0],i[1],o=this.list.length*(this.vsb.currentPage-1)+a,c=this.chunk.getRenderIndexDiff(o),((l=this.checkBigDiff(c))||this.vsb.isPageChanged)&&(clearTimeout(this.timerIdRefreshList),this.setTimerToRefreshList()),this.vsb.isLastPage&&(n>=this.scroll.lastPageMaxScroll||this.chunk.lastPageLastRenderIndex),this.chunk.startRenderIndex===a){t.next=24;break}if(h=this.chunk.startRenderIndex,this.chunk.setRenderIndex(a,this.vsb.currentPage,this.list.length,this.vsb.isLastPage),this.render){t.next=13;break}throw new Error(U.renderControllerIsUndefined);case 13:if(!this.render.isAllowRenderNearBorder(this.scroll.direction,this.chunk.startRenderIndex,1!==this.vsb.currentPage&&this.vsb.isLastPage)||!this.domMngr){t.next=24;break}if(this.timerIdRefreshList||(u=this.chunk.startRenderIndex<h?"up":"down")&&u!==this.scroll.direction&&(console.warn("================ Направления не совпадают!"),this.scroll.direction=u),"====== startRenderIndex -> ".concat(this.chunk.startRenderIndex," (").concat(this.chunk.itemIndex,"), page ").concat(this.vsb.currentPage,", (real: ").concat(this.scroll.direction,", temp: ").concat(u," ), isGoingFromBottom: ").concat(this.scroll.isGoingFromBottom,", ").concat(c," ======"),d={itemIndex:this.chunk.itemIndex,startRenderIndex:this.chunk.startRenderIndex,amount:this.chunk.amount,htmlHeight:this.chunk.htmlHeight},!this.isLazy||l){t.next=22;break}return g=this.getSequence(this.chunk.itemIndex),m=s(g,2),p=m[0],v=m[1],t.next=22,this.loadDataFromSources(p,v);case 22:this.domMngr.modifyCurrentDOM(d,this.list,this.scroll.direction,this.scroll.isGoingFromBottom,this.vsb);case 24:case"end":return t.stop()}}),t,this)}))),function(){return I.apply(this,arguments)})},{key:"checkBigDiff",value:function(t){var e=this.vsb.isLastPage?this.list.lastPageTailingElementsAmount:this.list.pageTailingElementsAmount;return this.scroll.isBigDiff(t,this.chunk.amount,e)}},{key:"loadDataFromSources",value:(P=o(f().mark((function t(e,n){var r,i,s=this;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[{name:"DB",loader:function(){var t=o(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.getItemsFromDB(e,n);case 2:return t.abrupt("return",s.checkItemForLoad(e,n));case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{name:"fetch",loader:function(){var t=o(f().mark((function t(e){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s.fetchUnfoundedRanges(e),t.abrupt("return",[]);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}],i=this.checkItemForLoad(e,n),t.next=4,r.reduce(function(){var t=o(f().mark((function t(e,n){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:if(0!==i.length){t.next=4;break}return t.abrupt("return",Promise.resolve());case 4:return"Unfounded (for ".concat(n.name,")"),t.next=7,n.loader(i);case 7:return i=t.sent,t.abrupt("return",Promise.resolve());case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Promise.resolve());case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return P.apply(this,arguments)})},{key:"refreshList",value:function(t){if(this.render){var e=this.chunk.startRenderIndex;this.chunk.setRenderIndex(e,this.vsb.currentPage,this.list.length,this.vsb.isLastPage),this.vsb.currentPage!==this.vsb.totalPages||this.vsb.isLastPage||console.error(this.vsb.currentPage,this.vsb.currentPage===this.vsb.totalPages,this.vsb.isLastPage);var n=s(this.getSequence(this.chunk.itemIndex,!0,this.vsb.isLastPage),2),r=n[0],i=n[1];if(this.isLazy){0;var a=[r,i];this.fetchUnfoundedRanges([a])}if(t&&t!==this.timerIdRefreshList)return;this.domMngr.resetAllList(this.chunk,e,r,this.list,this.scroll.direction,this.vsb),this.timerIdRefreshList=null}}},{key:"setTimerToRefreshList",value:function(){var t=this,e=window.setTimeout(o(f().mark((function n(){return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.refreshList(e);case 1:case"end":return n.stop()}}),n)}))),0);this.timerIdRefreshList=e}},{key:"checkApiSettings",value:(k=o(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b(this.dataUrl,this.subDir);case 2:return this.includeEnd=t.sent,t.next=5,w(this.dataUrl,this.includeEnd,this.subDir);case 5:this.basedIndex=t.sent;case 6:case"end":return t.stop()}}),t,this)}))),function(){return k.apply(this,arguments)})},{key:"setListData",value:function(t){var e=this;t.forEach((function(t,n){return e.setListDataByIndex(t,n)})),this.saveListData(t)}},{key:"saveListData",value:function(t){var e=this.list.data.map((function(t,e){return{index:e,value:t}}));this.dbmanager.writeMany(e)}},{key:"setListDataByIndex",value:function(t,e){this.list.data[e]=t}},{key:"saveListDataByIndex",value:function(t,e){this.dbmanager.write(e,t)}},{key:"getSavedListData",value:(d=o(f().mark((function t(){var e,n;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dbmanager.getStoreSize();case 2:if(!(t.sent<(e=10))){t.next=11;break}return t.next=8,this.dbmanager.readAll();case 8:n=t.sent,t.next=15;break;case 11:return console.warn("Объем закешированных данных слишком большой"),t.next=14,this.dbmanager.readRange(0,e-1);case 14:n=t.sent;case 15:return t.abrupt("return",n);case 16:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"setInitialListData",value:(l=o(f().mark((function t(e){var n,r,i,a,o,c,l,h,u,d=this;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null,"local"!==this.dataLoadPlace){t.next=6;break}this.list.data=e,n=this.forcedListLength||e&&e.length,t.next=36;break;case 6:if(i=E(r=e),a=s(i,2),o=a[0],c=a[1],o||c){t.next=10;break}throw new Error(U.notValidUrl);case 10:if(c){t.next=15;break}return t.next=13,y(r).then((function(t){var e=d.extractResponse(t);d.setListData(e),n=d.forcedListLength||e&&e.length}));case 13:t.next=36;break;case 15:return this.isLazy=!0,t.next=18,this.checkApiSettings();case 18:return this.includeEnd,this.basedIndex,l=this.basedIndex,h=this.basedIndex+Number(!this.includeEnd),t.next=24,this.getListDataLazy(l,h);case 24:if(u=t.sent,this.setListData(u),!this.forcedListLength){t.next=31;break}n=this.forcedListLength,t.next=36;break;case 31:return t.next=33,S(r,this.subDir);case 33:t.t0=t.sent,t.t1=Number(!this.basedIndex),n=t.t0+t.t1;case 36:if(Array.isArray(this.list.data)){t.next=38;break}throw new Error(U.notArray);case 38:if(n){t.next=40;break}throw new Error(U.zeroListSize);case 40:this.list.fullLength=n,this.list.length=n,this.skeleton.setListHeight(this.list.length);case 44:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"getSequence",value:function(t){var e,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(s){var a=this.list.length*(this.vsb.totalPages-1);r=a+this.list.lastPageLength}else r=this.list.length*this.vsb.currentPage;if(i){var o,c=t-this.chunk.amount,l=this.list.length*(this.vsb.currentPage-1);if(s){var h=this.list.length*(this.vsb.totalPages-1),u=this.list.lastPageLength-this.list.existingSizeInDOM;u<0&&(u=0),o=h+u}else o=this.list.length*this.vsb.currentPage-this.list.existingSizeInDOM;(e=c>l?c:l)>o&&(e=o),n=e+this.list.existingSizeInDOM}else(n=(e=B(this.scroll.direction,this.list.halfOfExistingSizeInDOM,t,this.chunk.amount))+this.chunk.amount)>r&&(n=r);this.list.fullLength,this.list.existingSizeInDOM,this.list.fullLength;return[e,n]}},{key:"fetchUnfoundedRanges",value:function(t){var e=this;t.forEach((function(t){var n=s(t,2),r=n[0],i=n[1],a=r+e.basedIndex,o=i+e.basedIndex-Number(e.includeEnd);L(e.dataUrl,a,o).then((function(t){if(0!==t.length){var n=e.extractResponse(t);e.addNewItemsToDataList(r,n),e.updateSkeletonItems(r,n)}}))}))}},{key:"addNewItemsToDataList",value:function(t,e){for(var n=e.length,r=0;r<n;r++){var i=t+r;this.setListDataByIndex(e[r],i),this.saveListDataByIndex(e[r],i)}}},{key:"updateSkeletonItems",value:function(t,e){for(var n=e.length,r=0;r<n;r++){var i=t+r+1,s='[aria-posinset="'.concat(i,'"]'),a=this.domMngr.targetElem.querySelector(s);a&&this.skeleton.updateElement(a,e[r],i)}}},{key:"getListItem",value:(a=o(f().mark((function t(e){var n;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===this.list.data[e]){t.next=4;break}n=this.list.data[e],t.next=21;break;case 4:return t.next=7,this.dbmanager.has(e);case 7:if(!t.sent){t.next=15;break}return t.next=11,this.dbmanager.get(e);case 11:n=t.sent,t.next=21;break;case 15:return t.t0=console,t.next=19,this.dbmanager.get(e);case 19:t.t1=t.sent,t.t0.log.call(t.t0,t.t1);case 21:return t.abrupt("return",n);case 22:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"getItemsFromDB",value:(r=o(f().mark((function t(e,n){var r,s;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dbmanager.readRange(e,n-1);case 2:s=t.sent,(r=this.list.data).splice.apply(r,[e,this.chunk.amount].concat(i(s)));case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})},{key:"checkItemForLoad",value:function(t,e){for(var n=[],r=!1,i=[],s=e-1,a=t;a<e;a++){var o=this.list.data[a];if(void 0===o&&!1===r)r=!0,i.push(a);else if(r&&(void 0!==o||a===s)){var c=a===s&&void 0===o?a+1:a;i.push(c),n.push(i.slice()),i.length=0,r=!1}}return n}},{key:"checkIndexOrdering",value:function(t){var e,n=this,r=null===(e=this.domMngr)||void 0===e?void 0:e.targetElem;if(!r)throw new Error(U.noTargetElem);var s=null,a=!0;return i(r.children).forEach((function(e){var r=Number(e.getAttribute("aria-posinset"));if(null!==s){if(s+1!==r){var i="Индексы поломались на элементе ".concat(r," (ожидали ").concat(s+1,"), isGoingFromBottom - ").concat(t);console.error("".concat(n.tests.name," -- ").concat(i,")")),Array.isArray(n.tests.errors.get(n.tests.name))||n.tests.errors.set(n.tests.name,[]),n.tests.errors.get(n.tests.name).push(i),a=!1}s=r}else s=r})),a}},{key:"getListDataLazy",value:(n=o(f().mark((function t(){var e,n,r,i=this,s=arguments;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=s.length>0&&void 0!==s[0]?s[0]:0,n=s.length>1&&void 0!==s[1]?s[1]:1,this.dataUrl){t.next=4;break}throw new Error(U.noDataUrl);case 4:if("string"!=typeof this.dataUrl){t.next=6;break}throw new Error(U.dataUrlNotAFn);case 6:return t.next=8,L(this.dataUrl,e,n).then((function(t){return i.extractResponse(t)}));case 8:return r=t.sent,t.abrupt("return",r);case 10:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"extractResponse",value:function(t){var e=Array.isArray(t)?t:this.subDir&&t[this.subDir];if(!Array.isArray(e))throw new Error(U.fetchedIsNotArray);return e}},{key:"fixElemsOrdering",value:function(t,e){var n=Number(this.listEl.firstChild.ariaPosInSet),r=Number(this.listEl.lastChild.ariaPosInSet),i=r-(this.vsb.currentPage-1)*this.list.length,a=this.list.existingSizeInDOM-1;if(e&&i!==this.list.lastPageLength){console.clear(),console.warn("Конец списка  поломан- надо ребутать по особому",i);var o=s(this.getSequence(this.chunk.itemIndex,!0,!0),1)[0];this.domMngr.resetAllList(this.chunk,this.list.lastPageStartIndexOfLastPart+this.chunk.amount,o,this.list,this.scroll.direction,this.vsb)}else{var c,l=!1;if("down"===t?r-a!==n&&(console.warn("Дай угадаю - верх списка поломался?"),c=r-this.list.existingSizeInDOM+this.chunk.amount,l=!0):"up"===t&&n+a!==r&&(console.warn("Дай угадаю - низ списка поломался?"),c=n+this.chunk.amount,l=!0),l){c-=this.list.length*(this.vsb.currentPage-1),console.warn("Ребутаем список чтобы спасти ситацию =)",c,this.chunk.startRenderIndex,this.scroll.direction,e);var h=s(this.getSequence(this.chunk.itemIndex,!0),2);h[0],h[1]}}}},{key:"setIndexedDb",value:(e=o(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=6,this.dbmanager.setTTL(6048e5);case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}()})(),self.InfinityScroll=r.InfinityScroll})();