(()=>{var t={207:(t,e,r)=>{t.exports=r(452)},452:t=>{var e=function(t){"use strict";var e,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,s=Object.create(i.prototype),a=new I(n||[]);return s._invoke=function(t,e,r){var n=h;return function(i,s){if(n===f)throw new Error("Generator is already running");if(n===p){if("throw"===i)throw s;return O()}for(r.method=i,r.arg=s;;){var a=r.delegate;if(a){var o=T(a,r);if(o){if(o===g)continue;return o}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=f;var c=u(t,e,r);if("normal"===c.type){if(n=r.done?p:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=p,r.method="throw",r.arg=c.arg)}}}(t,r,a),s}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var h="suspendedStart",d="suspendedYield",f="executing",p="completed",g={};function m(){}function v(){}function x(){}var y={};y[s]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(D([])));w&&w!==r&&n.call(w,s)&&(y=w);var k=x.prototype=m.prototype=Object.create(y);function L(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function S(t,e){function r(i,s,a,o){var c=u(t[i],t,s);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){r("next",t,a,o)},function(t){r("throw",t,a,o)}):e.resolve(h).then(function(t){l.value=t,a(l)},function(t){return r("throw",t,a,o)})}o(c.arg)}var i;this._invoke=function(t,n){function s(){return new e(function(e,i){r(t,n,e,i)})}return i=i?i.then(s,s):s()}}function T(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method))return g;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=u(n,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var s=i.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function D(t){if(t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}return{next:O}}function O(){return{value:e,done:!0}}return v.prototype=k.constructor=x,x.constructor=v,v.displayName=c(x,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,c(t,o,"GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},L(S.prototype),S.prototype[a]=function(){return this},t.AsyncIterator=S,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var a=new S(l(e,r,n,i),s);return t.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},L(k),c(k,o,"Generator"),k[s]=function(){return this},k.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=D,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return o.type="throw",o.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],o=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=t,a.arg=e,s?(this.method="next",this.next=s.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var s=e[n]={exports:{}};return t[n](s,s.exports,r),s.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var n={};(()=>{"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function e(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}function i(r){return function(e){if(Array.isArray(e))return t(e)}(r)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(r)||e(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,i=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,s=t}finally{try{n||null==o.return||o.return()}finally{if(i)throw s}}return r}}(t,r)||e(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e,r,n,i,s,a){try{var o=t[s](a),c=o.value}catch(t){return void r(t)}o.done?e(c):Promise.resolve(c).then(n,i)}function o(t){return function(){var e=this,r=arguments;return new Promise(function(n,i){var s=t.apply(e,r);function o(t){a(s,n,i,o,c,"next",t)}function c(t){a(s,n,i,o,c,"throw",t)}o(void 0)})}}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&l(t.prototype,e),r&&l(t,r),t}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(n,{InfinityScroll:()=>ot});var d=r(207),f=r.n(d),p=function(){function t(e){c(this,t),h(this,"lastRenderIndex",void 0),h(this,"lastPageLastRenderIndex",void 0),h(this,"listLength",void 0),h(this,"listlastPageLength",void 0),h(this,"chunkAmount",void 0),this.lastRenderIndex=e.lastRenderIndex,this.lastPageLastRenderIndex=e.lastPageLastRenderIndex,this.listLength=e.listLength,this.listlastPageLength=e.listlastPageLength,this.chunkAmount=e.chunkAmount}return u(t,[{key:"reInitValues",value:function(t,e){this.lastRenderIndex=t,this.listLength=e}},{key:"isBeginOfListFromTop",value:function(t){return t<=this.chunkAmount}},{key:"isEndOfListFromTop",value:function(t){return t>=this.lastRenderIndex}},{key:"isEndOfListLastPageFromTop",value:function(t){return t>=this.lastPageLastRenderIndex}},{key:"isBeginOfListFromBottom",value:function(t){return 0===t||t<0}},{key:"isEndOfListFromBottom",value:function(t){return t>=this.listLength-3*this.chunkAmount}},{key:"isEndOfListLastPageFromBottom",value:function(t){return t>=this.listlastPageLength-3*this.chunkAmount}},{key:"isAllowRenderNearBorder",value:function(t,e,r){var n="up"===t;return"down"===t?this.checkDownDirectionRender(e,r):!n||this.checkUpDirectionRender(e,r)}},{key:"checkDownDirectionRender",value:function(t,e){return!this.isBeginOfListFromTop(t)&&(!this.isEndOfListFromTop(t)&&(!e||!this.isEndOfListLastPageFromTop(t)))}},{key:"checkUpDirectionRender",value:function(t,e){return!(this.isBeginOfListFromBottom(t)||this.isEndOfListFromBottom(t)||e&&this.isEndOfListLastPageFromBottom(t))}}]),t}(),g=function(){function t(){c(this,t),h(this,"direction","down"),h(this,"isGoingFromBottom",!1),h(this,"maxScroll",0),h(this,"lastPageMaxScroll",0),h(this,"prevScroll",0)}return u(t,[{key:"setScrollDirection",value:function(t,e,r){t!==this.prevScroll&&(e||(t>this.prevScroll?this.direction="down":this.direction="up"),this.prevScroll=t)}},{key:"setGoingFromBottom",value:function(t,e,r,n,i){"down"===this.direction&&r<=1?this.isGoingFromBottom=!1:r>=e-1&&(this.isGoingFromBottom=!0),!this.isGoingFromBottom&&n>=i&&(this.isGoingFromBottom=!0)}},{key:"isBigDiff",value:function(t,e,r){var n=this.isGoingFromBottom&&t>e+r||!this.isGoingFromBottom&&t>e;return n}}]),t}(),m=function(){function t(){c(this,t),h(this,"amount",2),h(this,"htmlHeight",0),h(this,"firstOrderNumber",0),h(this,"lastOrderNumber",1),h(this,"lastPageLastOrderNumber",1),h(this,"lastRenderIndex",0),h(this,"lastPageLastRenderIndex",0),h(this,"startRenderIndex",0),h(this,"itemIndex",0),h(this,"prevPageRenderIndex",0)}return u(t,[{key:"getOrderNumber",value:function(t){return Math.floor(t/this.htmlHeight)}},{key:"getRenderIndexDiff",value:function(t){return Math.abs(this.itemIndex-t)}},{key:"calcRenderIndex",value:function(t){return t*this.amount}},{key:"setRenderIndex",value:function(t,e,r,n){n&&t>this.lastPageLastRenderIndex?this.startRenderIndex=this.lastPageLastRenderIndex:t>this.lastRenderIndex?this.startRenderIndex=this.lastRenderIndex:this.startRenderIndex=t,this.itemIndex=r*(e-1)+this.startRenderIndex}}]),t}(),v=function(){function t(){c(this,t),h(this,"data",void 0),h(this,"fullLength",0),h(this,"length",0),h(this,"lastPageLength",0),h(this,"existingSizeInDOM",0),h(this,"halfOfExistingSizeInDOM",0),h(this,"wrapperHeight",0),h(this,"itemHeight",0),h(this,"tailingElementsAmount",0),h(this,"pageTailingElementsAmount",0),h(this,"lastPageTailingElementsAmount",0),h(this,"startIndexOfLastPart",0),h(this,"lastPageStartIndexOfLastPart",0),this.data=[]}return u(t,[{key:"getTotalListHeight",value:function(){return this.itemHeight*this.fullLength}},{key:"setExistingSizeInDOM",value:function(t){this.existingSizeInDOM=Math.min(this.length,4*t)}}]),t}();function x(t){return Object.keys(t).some(function(e){return!t[e]&&0!==t[e]})}function y(t){return fetch(t).then(function(t){return t.json().then(function(t){return t}).catch(function(t){})})}function b(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return y(t({start:e,end:r,limit:arguments.length>3&&void 0!==arguments[3]?arguments[3]:r-e}))}function w(t,e){return k.apply(this,arguments)}function k(){return(k=o(f().mark(function t(e,r){var n,i;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b(e,1,2);case 2:if(n=t.sent,2!==(null==(i=Array.isArray(n)?n:r&&n[r])?void 0:i.length)){t.next=6;break}return t.abrupt("return",!0);case 6:if(1!==(null==i?void 0:i.length)){t.next=8;break}return t.abrupt("return",!1);case 8:throw new Error("Can't define include end of range");case 9:case"end":return t.stop()}},t)}))).apply(this,arguments)}function L(t,e,r){return S.apply(this,arguments)}function S(){return(S=o(f().mark(function t(e,r,n){var i,s,a,o,c;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=Number(!r),t.next=3,b(e,0,i);case 3:return s=t.sent,t.next=6,b(e,1,1+i);case 6:if(a=t.sent,o=Array.isArray(s)?s:n&&s[n],c=Array.isArray(a)?a:n&&a[n],1!==(null==o?void 0:o.length)){t.next=11;break}return t.abrupt("return",0);case 11:if(1!==(null==c?void 0:c.length)){t.next=13;break}return t.abrupt("return",1);case 13:throw new Error("Can't define base index");case 14:case"end":return t.stop()}},t)}))).apply(this,arguments)}function T(t){try{var e=new URL(t);return"http:"===e.protocol||"https:"===e.protocol}catch(t){return!1}}function E(t){return["string"==typeof t&&T(t),"function"==typeof t&&T(t({start:1,end:2}))]}function P(t,e){return t+1===e}function I(t,e){return D.apply(this,arguments)}function D(){return(D=o(f().mark(function t(e,r){var n;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.isArray(e)?e:r&&e[r],t.abrupt("return",n&&n.length>0);case 2:case"end":return t.stop()}},t)}))).apply(this,arguments)}function O(t,e,r){return R.apply(this,arguments)}function R(){return(R=o(f().mark(function t(e,r,n){var i,s,a,o,c;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i=1,s=0;case 2:return a=i,o=i+n,t.next=7,b(e,a,o);case 7:return c=t.sent,t.next=10,I(c,r);case 10:if(!t.sent){t.next=16;break}s=i,i*=10,t.next=17;break;case 16:return t.abrupt("return",{leftIndex:s,rightIndex:i});case 17:t.next=2;break;case 19:case"end":return t.stop()}},t)}))).apply(this,arguments)}function N(t,e,r,n,i,s){return H.apply(this,arguments)}function H(){return(H=o(f().mark(function t(e,r,n,i,s,a){var o,c,l,u,h;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o=n,c=i,l=0;case 3:if(!(l<a)||P(o,c)){t.next=17;break}return u=Math.ceil((o+c)/2),t.next=9,b(e,u,u+s);case 9:return h=t.sent,t.next=12,I(h,r);case 12:t.sent?o=u:c=u,l++,t.next=3;break;case 17:return t.abrupt("return",o);case 18:case"end":return t.stop()}},t)}))).apply(this,arguments)}function A(t,e){return M.apply(this,arguments)}function M(){return(M=o(f().mark(function t(e,r){var n,i,s,a;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=4,i=100,t.next=4,O(e,r,n);case 4:return s=t.sent,t.next=7,N(e,r,s.leftIndex,s.rightIndex,n,i);case 7:return a=t.sent,t.abrupt("return",a);case 9:case"end":return t.stop()}},t)}))).apply(this,arguments)}var C=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(function(e){setTimeout(function(){return e()},t)})},B=function(){function t(e){c(this,t),h(this,"targetElem",void 0),h(this,"GLOBAL_ITEM_COUNTER",0),h(this,"skeleton",void 0),h(this,"offsetElem",void 0),this.skeleton=e.skeleton,this.targetElem=e.targetElem}return u(t,[{key:"setHeightToList",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=t.length;e&&1!==e.currentPage&&e.currentPage===e.totalPages&&(n=t.lastPageLength);var i=n*t.itemHeight-r;this.targetElem.style.height="".concat(i,"px")}},{key:"calcStartOffsetIndex",value:function(t,e,r,n,i){var s=t-e;return s<0&&(s=0),i.currentPage===i.totalPages&&s>n.lastPageStartIndexOfLastPart?s=n.lastPageStartIndexOfLastPart:s>n.startIndexOfLastPart&&(s=n.startIndexOfLastPart),s}},{key:"setOffsetToList",value:function(t,e,r,n,i){var s=this.calcStartOffsetIndex(e,t.amount,n,r,i)*r.itemHeight;this.offsetElem.style.height="".concat(s,"px"),this.setHeightToList(r,i,s)}},{key:"createItem",value:function(t,e){return this.skeleton.createElement({data:t,dataIndex:e+1})}},{key:"removeItem",value:function(t){var e=this.targetElem[t];e&&this.targetElem.removeChild(e)}},{key:"fillList",value:function(t){if(!(this.GLOBAL_ITEM_COUNTER>49999||this.GLOBAL_ITEM_COUNTER>=t.length||this.GLOBAL_ITEM_COUNTER>=t.existingSizeInDOM)){for(var e=document.createDocumentFragment(),r=0;r<1e3&&r<t.length&&this.GLOBAL_ITEM_COUNTER<t.length&&this.GLOBAL_ITEM_COUNTER<t.existingSizeInDOM;r++){if(void 0===t.data)throw new Error("Your list.data is undefined");var n=t.data[this.GLOBAL_ITEM_COUNTER];e.append(this.createItem(n,this.GLOBAL_ITEM_COUNTER)),this.GLOBAL_ITEM_COUNTER++}this.targetElem.append(e)}}},{key:"calcSequenceByDirection",value:function(t,e,r,n){var i="down"===t?r+e:r-n;return i<0&&(i=0),i}},{key:"resetAllList",value:function(t,e,r,n,i,s){var a=document.createDocumentFragment(),o=n.existingSizeInDOM;1!==s.currentPage&&s.currentPage===s.totalPages&&n.lastPageLength<n.existingSizeInDOM&&(o=n.lastPageLength);for(var c=0;c<1e3&&c<o;c++){var l=c+r;if(void 0===n.data)throw new Error("Your list.data is undefined");var u=n.data[l];a.append(this.createItem(u,l))}this.targetElem.innerHTML="",this.targetElem.append(a),this.setOffsetToList(t,e,n,i,s)}},{key:"checkAllowToChangeList",value:function(t,e,r,n,i,s){var a=n+e,o=this.checkTopLimit(t,e,r,a,i,s),c=this.checkBottomLimit(t,a,i,s);return!o&&!c}},{key:"checkTopLimit",value:function(t,e,r,n,i,s){if(!r||!("up"===t&&0===e))return!1;var a=s.isLastPage?i.lastPageTailingElementsAmount:i.pageTailingElementsAmount;return 0!==a&&n>=a}},{key:"checkBottomLimit",value:function(t,e,r,n){return"down"===t&&(e>=r.length||!!(n.isLastPage&&e>=r.lastPageLength))}},{key:"prepareItems",value:function(t,e,r,n,i,s,a,o){for(var c=document.createDocumentFragment(),l=0;l<1e3&&l<t;l++){if(this.checkAllowToChangeList(e,r,n,l,i,s)){var u=l+o,h=i.data[u];c.append(this.createItem(h,u)),this.removeItem(a)}}return c}},{key:"putElementsToList",value:function(t,e){"down"===t?this.targetElem.append(e):this.targetElem.prepend(e)}},{key:"changeItemsInList",value:function(t,e,r,n,i){var s="down"===r?"firstChild":"lastChild",a=this.calcSequenceByDirection(r,e.halfOfExistingSizeInDOM,t.startRenderIndex,t.amount),o=(i.currentPage-1)*e.length+a;if(void 0===e.data)throw new Error("Your list.data is undefined");var c=this.prepareItems(t.amount,r,a,n,e,i,s,o);this.putElementsToList(r,c)}},{key:"modifyCurrentDOM",value:function(t,e,r,n,i){this.changeItemsInList(t,e,r,n,i),this.setOffsetToList(t,t.startRenderIndex,e,r,i)}}]),t}();function F(t){var e=document.createElement("table");return e.innerHTML="<tbody>".concat(t,"</tbody>"),e.firstElementChild.firstElementChild}function U(t){var e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}function z(t){t.classList.add("loading"),t.innerHTML=t.innerHTML.replaceAll("undefined","Loading")}function _(t){t.classList.add("loading"),t.innerHTML='<td colspan="2">Loading<span class="dots">...</span></td>'}function j(t){var e=t.tagName,r=void 0===e?"div":e,n=t.className,i=t.text,s=document.createElement(r);return Array.isArray(n)?n.forEach(function(t){s.classList.add(t)}):n&&s.classList.add(n),i&&(s.textContent=i),s}function W(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:700;t.classList.add(e),setTimeout(function(){t.classList.remove(e)},r)}var G=function(){function t(e){c(this,t),h(this,"template",void 0),h(this,"templateCb",void 0),h(this,"listLength",0),h(this,"makeItemFromString",void 0),h(this,"setLoadingPlaceholder",void 0),this.template=e.template,this.templateCb=e.templateCb,this.makeItemFromString="table"!==e.listType?U:F,this.setLoadingPlaceholder="table"!==e.listType?z:_}return u(t,[{key:"setListLength",value:function(t){this.listLength=t}},{key:"setRequiredAttrs",value:function(t){var e=t.element,r=t.dataIndex;e.setAttribute("aria-setsize",this.listLength.toString()),e.setAttribute("aria-posinset",r.toString())}},{key:"updateElement",value:function(t,e,r){var n=this.template({item:e,listLength:this.listLength,idx:r,templateCb:this.templateCb}),i=this.makeItemFromString(n);this.setRequiredAttrs({element:i,dataIndex:r}),t.replaceWith(i)}},{key:"createElement",value:function(t){var e=t.data,r=t.dataIndex,n=this.template({item:e||{},listLength:this.listLength,idx:r,templateCb:this.templateCb}),i=this.makeItemFromString(n);return e||this.setLoadingPlaceholder(i),this.setRequiredAttrs({element:i,dataIndex:r}),i}}]),t}(),Y=function(){function t(e){if(c(this,t),h(this,"srcElement",void 0),h(this,"scrollBarWrp",void 0),h(this,"track",void 0),h(this,"thumb",void 0),h(this,"thumbHeight",0),h(this,"dragStartY",0),h(this,"dragStartScrollTop",0),h(this,"isDragging",!1),this.srcElement="string"==typeof e?document.querySelector(e):e,!this.srcElement)throw new Error("Element not found");this.init()}return u(t,[{key:"init",value:function(){this.createWrapper(),this.createScrollbar(),this.addEventListeners(),this.updateScrollbar()}},{key:"createWrapper",value:function(){if(this.scrollBarWrp=j({className:"mobileScrollbar-wrapper"}),!this.srcElement.parentNode)throw new Error("Element must be in the DOM and have a parent node");this.srcElement.parentNode.insertBefore(this.scrollBarWrp,this.srcElement),this.scrollBarWrp.appendChild(this.srcElement),this.srcElement.className+=" mobileScrollbar-srcElem"}},{key:"createScrollbar",value:function(){this.track=j({className:"mobileScrollbar-track"}),this.thumb=j({className:"mobileScrollbar-thumb"}),this.track.appendChild(this.thumb),this.scrollBarWrp.appendChild(this.track)}},{key:"addEventListeners",value:function(){var t=this;this.srcElement.addEventListener("scroll",function(){return t.updateScrollbar()}),window.addEventListener("resize",function(){return t.updateScrollbar()}),this.thumb.addEventListener("mousedown",function(e){return t.startDrag(e)}),document.addEventListener("mousemove",function(e){return t.onDrag(e)}),document.addEventListener("mouseup",function(){return t.endDrag()}),this.thumb.addEventListener("touchstart",function(e){return t.startDrag(e.touches[0])}),document.addEventListener("touchmove",function(e){t.isDragging&&(e.preventDefault(),t.onDrag(e.touches[0]))},{passive:!1}),document.addEventListener("touchend",function(){return t.endDrag()}),this.track.addEventListener("click",function(e){return t.onTrackClick(e)})}},{key:"updateScrollbar",value:function(){var t=this.srcElement,e=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;if(r<=n)this.track.style.display="none";else{this.track.style.display="block",this.thumbHeight=Math.max(n/r*n,20);var i=e/(r-n)*(n-this.thumbHeight);this.thumb.style.height="".concat(this.thumbHeight,"px"),this.thumb.style.transform="translateY(".concat(i,"px)")}}},{key:"startDrag",value:function(t){this.isDragging=!0,this.dragStartY=t.clientY||t.pageY,this.dragStartScrollTop=this.srcElement.scrollTop,document.body.style.userSelect="none"}},{key:"onDrag",value:function(t){if(this.isDragging){var e=(t.clientY||t.pageY)-this.dragStartY,r=this.srcElement,n=r.scrollHeight,i=r.clientHeight,s=e/(i-this.thumbHeight),a=this.dragStartScrollTop+s*(n-i);this.srcElement.scrollTop=Math.max(0,Math.min(n-i,a))}}},{key:"endDrag",value:function(){this.isDragging=!1,document.body.style.userSelect=""}},{key:"onTrackClick",value:function(t){if(t.target!==this.thumb){var e=this.track.getBoundingClientRect(),r=t.clientY-e.top,n=this.srcElement,i=n.scrollHeight,s=n.clientHeight,a=(r-this.thumbHeight/2)/(s-this.thumbHeight)*(i-s);this.smoothScrollTo(Math.max(0,Math.min(i-s,a)))}}},{key:"smoothScrollTo",value:function(t){var e=this,r=this.srcElement.scrollTop,n=t-r,i=null;requestAnimationFrame(function t(s){null===i&&(i=s);var a=s-i,o=Math.min(a/300,1),c=1-Math.pow(1-o,3);e.srcElement.scrollTop=r+n*c,o<1&&requestAnimationFrame(t)})}},{key:"refresh",value:function(){this.updateScrollbar()}},{key:"scrollTo",value:function(t){this.srcElement.scrollTop=t}},{key:"scrollToTop",value:function(){this.smoothScrollTo(0)}},{key:"scrollToBottom",value:function(){this.smoothScrollTo(this.srcElement.scrollHeight)}}]),t}();var q=function(){function t(e,r){var n,i,s;c(this,t),h(this,"elem",void 0),h(this,"origScrollElem",void 0),h(this,"currentPage",void 0),h(this,"totalPages",void 0),h(this,"fillerHeight",void 0),h(this,"scroll",void 0),h(this,"safeLimit",void 0),h(this,"scrollPercent",void 0),h(this,"sizeOfPercentByOnePage",void 0),h(this,"sizeOfScrollByOnePage",void 0),h(this,"isPageChanged",!1),h(this,"isLastPage",!1),h(this,"scrollRatio",void 0),h(this,"setHeight",void 0),h(this,"isSyncing",!1),h(this,"deviceType",void 0),h(this,"browserName",void 0),this.currentPage=1,this.totalPages=1,this.fillerHeight=1,this.scroll=1,this.safeLimit=11100,this.scrollPercent=0,this.sizeOfPercentByOnePage=1,this.sizeOfScrollByOnePage=1,this.scrollRatio=1,this.deviceType=(n="ontouchstart"in window||navigator.maxTouchPoints>0,i=window.innerWidth,n?i<=767?"mobile":i<=1024?"tablet":"touchDesktop":"desktop"),this.browserName=(s=navigator.userAgent,/Edg\//.test(s)?"microsoftEdge":/OPR\//.test(s)?"opera":!/Chrome\//.test(s)||/Edg\//.test(s)||/OPR\//.test(s)?/Safari\//.test(s)&&!/Chrome\//.test(s)?"safari":/Firefox\//.test(s)?"mozillaFirefox":/MSIE|Trident/.test(s)?"internetExplorer":void 0:"googleChrome"),this.elem=j({className:["vSrcollbar","vSrcollbar_".concat(this.browserName)]}),e&&this.elem.classList.add("vSrcollbar_debugMode"),this.elem.addEventListener("scroll",r)}return u(t,[{key:"init",value:function(t){t.totalHeight;var e=t.realHeight,r=t.fullLength,n=t.listLength,i=(t.lastPageLength,t.origScrollElem);if(this.origScrollElem=i,this.createFiller(e),this.countTotalPages(r,n),this.setScrollRatio(r,n),this.sizeOfPercentByOnePage=1/this.totalPages*this.scrollRatio,this.sizeOfScrollByOnePage=this.fillerHeight/this.totalPages*this.scrollRatio,"desktop"!==this.deviceType)new Y(this.elem)}},{key:"createFiller",value:function(t){var e,r=j({className:"vScrollbarFiller"});r.style.height="".concat(t,"px"),this.fillerHeight=t-(null===(e=this.origScrollElem)||void 0===e?void 0:e.clientHeight),this.elem.append(r)}},{key:"countTotalPages",value:function(t,e){var r=e;r>t&&(r=t);var n=t%r,i=(t-n)/r+(0===n?0:1);return this.totalPages=i,i}},{key:"handleScroll",value:function(){this.scroll=this.elem.scrollTop,this.syncScrollState()}},{key:"setScrollFromOuterSrc",value:function(t,e){var r=this.sizeOfScrollByOnePage*(this.currentPage-1)+t*this.scrollRatio/this.totalPages,n=this.checkAndHandlePageChange(t,e);this.scroll=r,this.elem.scrollTop=this.scroll,this.isLastPage=this.currentPage===this.totalPages,n&&this.handlePageChangeComplete(e)}},{key:"checkAndHandlePageChange",value:function(t,e){return this.shouldChangePageDown(t,e)?(this.currentPage++,!0):!!this.shouldChangePageUp(t,e)&&(this.currentPage--,!0)}},{key:"shouldChangePageDown",value:function(t,e){return"down"===e&&t>=this.fillerHeight&&this.currentPage<this.totalPages}},{key:"shouldChangePageUp",value:function(t,e){return"up"===e&&t<=1&&this.currentPage>1}},{key:"handlePageChangeComplete",value:function(t){this.setScrollPercent(),this.isPageChanged=!0;var e="up"===t&&this.currentPage===this.totalPages-1;this.setHeight&&e&&this.setHeight(),this.setScrollToOrigScrollElem(t,!0)}},{key:"syncScrollState",value:function(t){this.setScrollPercent(),this.setCurrentPage(),this.setScrollToOrigScrollElem(t)}},{key:"setCurrentPage",value:function(){var t=this.getPageByScroll();this.isPageChanged=this.currentPage!==t,this.currentPage=t,this.isLastPage=this.currentPage===this.totalPages}},{key:"setScrollToOrigScrollElem",value:function(t,e){if(e)this.origScrollElem.scrollTop="down"===t?1:this.fillerHeight-1;else{var r=(this.currentPage-1)*this.sizeOfPercentByOnePage,n=(this.scrollPercent-r)*this.totalPages,i=this.fillerHeight*n/this.scrollRatio;this.origScrollElem.scrollTop=i}}},{key:"setScrollPercent",value:function(){this.scrollPercent=this.scroll/this.fillerHeight}},{key:"getPageByScroll",value:function(){var t=this.scrollPercent*this.totalPages/this.scrollRatio;return Math.ceil(t)||1}},{key:"setScrollRatio",value:function(t,e){var r=e*this.totalPages,n=t;this.scrollRatio=r/n,this.scrollRatio}}]),t}();function Q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function V(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(r),!0).forEach(function(e){h(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var K,J=function(){function t(e){c(this,t),h(this,"storeName",void 0),this.storeName=e}var e,r,n,i,s,a,l,d,p,g,m,v,x,y,b;return u(t,[{key:"addToWaitingQueue",value:function(e){var r=this;return new Promise(function(n){t.waitingQueue.push(o(f().mark(function t(){var r;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:r=t.sent,n(r);case 4:case"end":return t.stop()}},t)}))),t.isWorking||r.handleQueue()})}},{key:"handleQueue",value:(b=o(f().mark(function e(){var r;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isWorking){e.next=2;break}return e.abrupt("return");case 2:t.isWorking=!0,r=function(){var e=o(f().mark(function e(){var n;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.waitingQueue.length){e.next=3;break}return t.isWorking=!1,e.abrupt("return");case 3:return n=t.waitingQueue.shift(),e.next=6,null==n?void 0:n();case 6:r();case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),r();case 5:case"end":return e.stop()}},e)})),function(){return b.apply(this,arguments)})},{key:"queuedOpenDb",value:(y=o(f().mark(function e(r){var n,i,s,a;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.openDatabase(t.TTL_STORE);case 2:return n=e.sent,i=n.transaction(t.TTL_STORE,"readwrite"),s=i.objectStore(t.TTL_STORE),a={storeName:this.storeName,createdAt:Date.now(),ttlMs:r},s.put(a),e.abrupt("return",new Promise(function(t){i.oncomplete=function(){n.close(),t(a)}}));case 8:case"end":return e.stop()}},e,this)})),function(t){return y.apply(this,arguments)})},{key:"setTTL",value:(x=o(f().mark(function t(e){var r,n,i=this;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.addToWaitingQueue(o(f().mark(function t(){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.queuedOpenDb(e));case 1:case"end":return t.stop()}},t)})));case 2:return r=t.sent,n=V(V({},r),{},{createdAt:new Date(r.createdAt).toLocaleString()}),t.abrupt("return",n);case 5:case"end":return t.stop()}},t,this)})),function(t){return x.apply(this,arguments)})},{key:"openDatabase",value:(v=o(f().mark(function e(r){var n=this;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,i){var s=indexedDB.open(t.DB_NAME);s.onupgradeneeded=function(){var e=s.result;e.objectStoreNames.contains(t.TTL_STORE)||e.createObjectStore(t.TTL_STORE,{keyPath:"storeName"}),e.objectStoreNames.contains(r)||e.createObjectStore(r)},s.onsuccess=function(){var a=s.result;if(a.objectStoreNames.contains(r))e(a);else{n.storeName,a.close();var o=indexedDB.open(t.DB_NAME,a.version+1);o.onupgradeneeded=function(){n.storeName,o.result.createObjectStore(r)},o.onsuccess=function(){return e(o.result)},o.onerror=function(){return i(o.error)}}},s.onerror=function(){return i(s.error)}}));case 1:case"end":return e.stop()}},e)})),function(t){return v.apply(this,arguments)})},{key:"isExpired",value:(m=o(f().mark(function e(){var r,n,i,s;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.openDatabase(t.TTL_STORE);case 2:return r=e.sent,n=r.transaction(t.TTL_STORE,"readonly"),i=n.objectStore(t.TTL_STORE),s=i.get(this.storeName),e.abrupt("return",new Promise(function(t){s.onsuccess=function(){r.close();var e=s.result;if(!e)return t(!1);t(Date.now()>e.createdAt+e.ttlMs)},s.onerror=function(){r.close(),t(!1)}}));case 7:case"end":return e.stop()}},e,this)})),function(){return m.apply(this,arguments)})},{key:"clearIfExpired",value:(g=o(f().mark(function t(){var e,r;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.isExpired();case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:return console.warn("Your data in store '".concat(this.storeName,"' is expired!")),t.next=8,this.openDatabase(this.storeName);case 8:return e=t.sent,(r=e.transaction(this.storeName,"readwrite")).objectStore(this.storeName).clear(),t.abrupt("return",new Promise(function(t){r.oncomplete=function(){e.close(),t()}}));case 12:case"end":return t.stop()}},t,this)})),function(){return g.apply(this,arguments)})},{key:"write",value:(p=o(f().mark(function t(e,r){var n=this;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.addToWaitingQueue(o(f().mark(function t(){var i,s;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.openDatabase(n.storeName);case 2:return i=t.sent,(s=i.transaction(n.storeName,"readwrite")).objectStore(n.storeName).put(r,e),t.abrupt("return",new Promise(function(t,e){s.oncomplete=function(){i.close(),t({})},s.onerror=function(){i.close(),e(s.error)}}));case 7:case"end":return t.stop()}},t)})));case 2:case"end":return t.stop()}},t,this)})),function(t,e){return p.apply(this,arguments)})},{key:"writeMany",value:(d=o(f().mark(function t(e){var r=this;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.addToWaitingQueue(o(f().mark(function t(){var n,i,s;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.openDatabase(r.storeName);case 2:return n=t.sent,i=n.transaction(r.storeName,"readwrite"),s=i.objectStore(r.storeName),e.forEach(function(t){var e=t.value,r=t.index;if(!("id"in e))throw new Error('All objects must contain an "id" property to be used as the key.');s.put(e,r)}),t.abrupt("return",new Promise(function(t,e){i.oncomplete=function(){n.close(),t({})},i.onerror=function(){n.close(),e(i.error)}}));case 7:case"end":return t.stop()}},t)})));case 2:case"end":return t.stop()}},t,this)})),function(t){return d.apply(this,arguments)})},{key:"readAll",value:(l=o(f().mark(function t(){var e,r,n,i;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.clearIfExpired();case 2:return t.next=4,this.openDatabase(this.storeName);case 4:return e=t.sent,r=e.transaction(this.storeName,"readonly"),n=r.objectStore(this.storeName),i=[],t.abrupt("return",new Promise(function(t,r){var s=n.openCursor();s.onsuccess=function(){var r=s.result;if(r){var n=r.key;i[n]=r.value,r.continue()}else e.close(),t(i)},s.onerror=function(){e.close(),r(s.error)}}));case 9:case"end":return t.stop()}},t,this)})),function(){return l.apply(this,arguments)})},{key:"readRange",value:(a=o(f().mark(function t(e,r){var n,i,s,a,o;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.clearIfExpired();case 2:return t.next=4,this.openDatabase(this.storeName);case 4:return n=t.sent,i=n.transaction(this.storeName,"readonly"),s=i.objectStore(this.storeName),a=IDBKeyRange.bound(e,r),o=new Array(r-e+1),t.abrupt("return",new Promise(function(t,r){var i=s.openCursor(a);i.onsuccess=function(){var r=i.result;if(r){var s=r.key;o[s-e]=r.value,r.continue()}else n.close(),t(o)},i.onerror=function(){n.close(),r(i.error)}}));case 10:case"end":return t.stop()}},t,this)})),function(t,e){return a.apply(this,arguments)})},{key:"getLastKey",value:(s=o(f().mark(function t(){var e,r,n;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openDatabase(this.storeName);case 2:return e=t.sent,r=e.transaction(this.storeName,"readonly"),n=r.objectStore(this.storeName),t.abrupt("return",new Promise(function(t,r){var i=n.openCursor(null,"prev");i.onsuccess=function(){var r=i.result;e.close(),t(r?r.key:void 0)},i.onerror=function(){e.close(),r(i.error)}}));case 6:case"end":return t.stop()}},t,this)})),function(){return s.apply(this,arguments)})},{key:"get",value:(i=o(f().mark(function t(e){var r,n,i;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.clearIfExpired();case 2:return t.next=4,this.openDatabase(this.storeName);case 4:return r=t.sent,n=r.transaction(this.storeName,"readonly"),i=n.objectStore(this.storeName),t.abrupt("return",new Promise(function(t,n){var s=i.get(e);s.onsuccess=function(){r.close(),t(s.result)},s.onerror=function(){r.close(),n(s.error)}}));case 8:case"end":return t.stop()}},t,this)})),function(t){return i.apply(this,arguments)})},{key:"has",value:(n=o(f().mark(function t(e){var r,n,i;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openDatabase(this.storeName);case 2:return r=t.sent,n=r.transaction(this.storeName,"readonly"),i=n.objectStore(this.storeName),t.abrupt("return",new Promise(function(t){var n=i.count(e);n.onsuccess=function(){r.close(),t(n.result>0)},n.onerror=function(){r.close(),t(!1)}}));case 6:case"end":return t.stop()}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"getStoreSize",value:(r=o(f().mark(function t(){var e,r,n;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openDatabase(this.storeName);case 2:return e=t.sent,r=e.transaction(this.storeName,"readonly"),n=r.objectStore(this.storeName),t.abrupt("return",new Promise(function(t,r){var i=n.count();i.onsuccess=function(){e.close(),t(i.result)},i.onerror=function(){e.close(),r(i.error)}}));case 6:case"end":return t.stop()}},t,this)})),function(){return r.apply(this,arguments)})}],[{key:"build",value:function(e){return t.checkIndexedDBSupport().then(function(r){return new t(e)},function(t){})}},{key:"checkIndexedDBSupport",value:(e=o(f().mark(function t(){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,e){if("indexedDB"in window){var r,n="support-test-".concat(Date.now()),i=indexedDB.open(n,1);i.onupgradeneeded=function(t){var e=t.target;r=e.result},i.onsuccess=function(e){var i=e.target;(r=i.result).close(),indexedDB.deleteDatabase(n),t("IndexedDB полностью поддерживается")},i.onerror=function(t){var r=t.target;e(new Error("Ошибка при создании/открытии базы: ".concat(r.error)))},i.onblocked=function(t){e(new Error("Операция с IndexedDB заблокирована"))},setTimeout(function(){r&&r.close(),e(new Error("Таймаут при проверке IndexedDB"))},5e3)}else e(new Error("IndexedDB не поддерживается браузером"))}));case 1:case"end":return t.stop()}},t)})),function(){return e.apply(this,arguments)})}]),t}();h(J,"DB_NAME","iScrollDB"),h(J,"TTL_STORE","__ttl__"),h(J,"waitingQueue",[]),h(J,"isWorking",!1),function(t){t.Initial="initialization",t.Loading="loading data",t.Ready="ready",t.Error="error"}(K||(K={}));var $=function(){function t(e){c(this,t),h(this,"statusListeners",[]),h(this,"is",K.Initial),h(this,"cb",void 0),this.cb=e}return u(t,[{key:"setStatus",value:function(t){this.is!==t&&(this.is=t,this.statusListeners.forEach(function(e){return e(t)}),this.cb&&this.cb(t))}},{key:"waitForStatus",value:function(t){var e=this;return this.is===t?Promise.resolve(this.is):new Promise(function(r,n){e.statusListeners.push(function i(s){s===t?(e.removeStatusListener(i),r(s)):s===K.Error&&t!==K.Error&&(e.removeStatusListener(i),n(new Error("Status changed to error while waiting for ".concat(t))))})})}},{key:"whenReady",value:function(){return this.waitForStatus(K.Ready).then(function(){})}},{key:"removeStatusListener",value:function(t){var e=this.statusListeners.indexOf(t);e>-1&&this.statusListeners.splice(e,1)}},{key:"reset",value:function(){this.setStatus(K.Initial)}},{key:"isReady",get:function(){return this.is===K.Ready}},{key:"isLoading",get:function(){return this.is===K.Loading}},{key:"hasError",get:function(){return this.is===K.Error}}]),t}();var X="background-color: lightgreen; color: white; font-weight: bold;",Z="background-color: gray; color: white; font-weight: bold;",tt="background-color: tomato; color: white; font-weight: bold;",et=function(){function t(e){var r=this,n=e.context;c(this,t),h(this,"vsb",void 0),h(this,"fillerHeight",void 0),h(this,"scrollElem",void 0),h(this,"repeats",void 0),h(this,"scrollStepSize",void 0),h(this,"chunkHeight",void 0),h(this,"context",void 0),h(this,"run",{}),h(this,"scrollUp",function(){return new Promise(function(t){for(var e=10*r.repeats+30,n=0;n<r.repeats;n++)setTimeout(function(){r.vsb.elem.scrollTop-=r.scrollStepSize},10*n);setTimeout(function(){return t()},e)})}),h(this,"scrollDown",function(){return new Promise(function(t){for(var e=10*r.repeats+30,n=0;n<r.repeats;n++)setTimeout(function(){r.vsb.elem.scrollTop+=r.scrollStepSize},10*n);setTimeout(function(){return t()},e)})}),h(this,"scrollToNow",function(t){return new Promise(function(e){r.scrollElem.scrollTop=t,setTimeout(e,0)})}),h(this,"scrollTo",function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise(function(n){setTimeout(o(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.scrollToNow(t);case 2:n();case 3:case"end":return e.stop()}},e)})),e)})}),h(this,"scrollToTop",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return r.scrollTo(0,t)}),h(this,"scrollToBottom",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return r.scrollTo(r.fillerHeight,t)}),h(this,"scrollToTopNow",function(){return r.scrollToNow(0)}),h(this,"scrollToBottomNow",function(){return r.scrollToNow(r.fillerHeight)}),this.context=n,this.vsb=n.vsb,this.fillerHeight=n.vsb.fillerHeight,this.scrollElem=n.vsb.elem,this.repeats=33,this.scrollStepSize=Math.ceil(this.fillerHeight/this.repeats),this.chunkHeight=n.chunk.htmlHeight,this.init()}var e,r;return u(t,[{key:"init",value:function(){this.createMethods()}},{key:"resetState",value:(r=o(f().mark(function t(){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,this.scrollToTopNow();case 3:return t.next=5,this.scrollDown();case 5:return t.next=7,this.scrollUp();case 7:return t.abrupt("return",Promise.resolve());case 8:case"end":return t.stop()}},t,this)})),function(){return r.apply(this,arguments)})},{key:"testStartSignal",value:(e=o(f().mark(function t(){var e,r,n,i=arguments;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(r=function(t){setTimeout(function(){"%c ".concat(t,"! ")},1e3*(e-t))},n=e=i.length>0&&void 0!==i[0]?i[0]:3;n>0;n--)r(n);return t.abrupt("return",new Promise(function(t){setTimeout(t,1e3*e)}));case 4:case"end":return t.stop()}},t)})),function(){return e.apply(this,arguments)})},{key:"createAsyncTestFunction",value:function(t,e){var r=this,n=function(){var n=o(f().mark(function n(){var i,s,a=arguments;return f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=a.length>0&&void 0!==a[0]?a[0]:3,s=!(a.length>1&&void 0!==a[1])||a[1],r.context.testResults.currentTestName=t,n.next=5,r.testStartSignal(i);case 5:return"%c --- start  fn: ".concat(t,"  --- "),n.next=8,e();case 8:return"%c --- end  fn: ".concat(t,"  --- "),n.next=11,C(200);case 11:if(!s){n.next=14;break}return n.next=14,r.resetState();case 14:r.context.testResults.currentTestName="","%c --- END TEST: ".concat(t,"  --- ");case 16:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}}();return n}},{key:"createMethods",value:function(){var t=this;this.run.testLocalSimple100item=this.createAsyncTestFunction("LocalSimple100item",o(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.scrollTo(3050,1e3);case 2:return e.next=4,t.scrollTo(2750,200);case 4:return e.next=6,t.scrollToTop(50);case 6:return e.next=8,t.scrollTo(1.5*t.chunkHeight,500);case 8:case"end":return e.stop()}},e)}))),this.run.testRemoteSimple500item=this.createAsyncTestFunction("RemoteSimple500item",o(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.scrollDown();case 2:return e.next=4,t.scrollUp();case 4:case"end":return e.stop()}},e)}))),this.run.testRemoteLazyDummyjsonAPI=this.createAsyncTestFunction("testRemoteLazyDummyjsonAPI",o(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.scrollToNow(900);case 2:return e.next=4,t.scrollToBottomNow();case 4:return e.next=6,t.scrollTo(0,300);case 6:return e.next=8,t.scrollTo(1.5*t.chunkHeight,300);case 8:return e.next=10,t.scrollTo(t.fillerHeight-1.5*t.chunkHeight,300);case 10:return e.next=12,t.scrollTo(3*t.chunkHeight,300);case 12:return e.next=14,t.scrollToNow(t.chunkHeight/2);case 14:return e.next=16,t.scrollDown();case 16:return e.next=18,t.scrollToTopNow();case 18:return e.next=20,t.scrollToNow(t.fillerHeight/2);case 20:return e.next=22,t.scrollDown();case 22:return e.next=24,t.scrollToNow(t.fillerHeight/2);case 24:return e.next=26,t.scrollUp();case 26:return console.warn("-------------------"),e.next=29,t.scrollToNow(900);case 29:return e.next=31,t.scrollToBottomNow();case 31:return e.next=33,t.scrollTo(0,300);case 33:return t.scrollUp(),e.next=36,t.scrollTo(1.5*t.chunkHeight,300);case 36:return e.next=38,t.scrollTo(t.fillerHeight-1.5*t.chunkHeight,300);case 38:return e.next=40,t.scrollDown().then(o(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.scrollTo(3*t.chunkHeight,400),t.scrollTo(5*t.chunkHeight,800),t.scrollTo(t.chunkHeight,1200),t.scrollToNow(t.chunkHeight/2),e.next=6,t.scrollUp();case 6:return e.next=8,t.scrollDown();case 8:return e.next=10,t.scrollUp();case 10:return e.next=12,t.scrollDown();case 12:return e.next=14,t.scrollUp();case 14:return e.next=16,t.scrollDown();case 16:return e.next=18,t.scrollUp();case 18:return e.next=20,t.scrollDown();case 20:return e.next=22,t.scrollUp();case 22:case"end":return e.stop()}},e)})));case 40:return e.next=42,t.scrollDown();case 42:return t.scrollToNow(t.fillerHeight/2),t.scrollTo(t.fillerHeight/2,1200),e.next=46,t.scrollDown();case 46:return t.scrollToNow(t.fillerHeight/2),e.next=49,t.scrollUp();case 49:case"end":return e.stop()}},e)}))),this.run.smoothUpDownScrollDomTest=this.createAsyncTestFunction("smoothUpDownScrollDomTest",o(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.scrollDown();case 2:return e.next=4,t.scrollUp();case 4:return e.next=6,t.scrollDown();case 6:return e.next=8,t.scrollUp();case 8:return e.next=10,t.scrollDown();case 10:return e.next=12,t.scrollUp();case 12:return e.next=14,t.scrollDown();case 14:return e.next=16,t.scrollUp();case 16:return e.next=18,t.scrollDown();case 18:return e.next=20,t.scrollUp();case 20:case"end":return e.stop()}},e)}))),this.run.fastUpDownScrollDomTest=this.createAsyncTestFunction("fastUpDownScrollDomTest",o(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.scrollToBottom();case 2:return e.next=4,t.scrollToTop(150);case 4:return e.next=6,t.scrollToBottom(150);case 6:return e.next=8,t.scrollToTop(150);case 8:return e.next=10,t.scrollToBottom(150);case 10:return e.next=12,t.scrollToTop(150);case 12:return e.next=14,t.scrollToBottom(150);case 14:return e.next=16,t.scrollToTop(150);case 16:return e.next=18,t.scrollToBottom(150);case 18:return e.next=20,t.scrollToTop(150);case 20:return e.next=22,t.scrollToBottom(150);case 22:return e.next=24,t.scrollToTop(150);case 24:case"end":return e.stop()}},e)}))),this.run.chaoticScrollDomTest=this.createAsyncTestFunction("chaoticScrollDomTest",o(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.scrollToNow(900);case 2:return e.next=4,t.scrollToBottomNow();case 4:return e.next=6,t.scrollTo(0,300);case 6:return e.next=8,t.scrollTo(1.5*t.chunkHeight,300);case 8:return e.next=10,t.scrollTo(t.fillerHeight-1.5*t.chunkHeight,300);case 10:return e.next=12,t.scrollTo(3*t.chunkHeight,300);case 12:return e.next=14,t.scrollToNow(t.chunkHeight/2);case 14:return e.next=16,t.scrollDown();case 16:return e.next=18,t.scrollToTopNow();case 18:return e.next=20,t.scrollToNow(t.fillerHeight/2);case 20:return e.next=22,t.scrollDown();case 22:return e.next=24,t.scrollToNow(t.fillerHeight/2);case 24:return e.next=26,t.scrollUp();case 26:case"end":return e.stop()}},e)}))),this.run.asyncChaoticScrollDomTest=this.createAsyncTestFunction("asyncChaoticScrollDomTest",o(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.scrollToNow(900);case 2:return e.next=4,t.scrollToBottomNow();case 4:return e.next=6,t.scrollTo(0,300);case 6:return t.scrollUp(),e.next=9,t.scrollTo(1.5*t.chunkHeight,300);case 9:return e.next=11,t.scrollTo(t.fillerHeight-1.5*t.chunkHeight,300);case 11:return e.next=13,t.scrollDown().then(o(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.scrollTo(3*t.chunkHeight,400),t.scrollTo(5*t.chunkHeight,800),t.scrollTo(t.chunkHeight,1200),t.scrollToNow(t.chunkHeight/2),e.next=6,t.scrollUp();case 6:return e.next=8,t.scrollDown();case 8:return e.next=10,t.scrollUp();case 10:return e.next=12,t.scrollDown();case 12:return e.next=14,t.scrollUp();case 14:return e.next=16,t.scrollDown();case 16:return e.next=18,t.scrollUp();case 18:return e.next=20,t.scrollDown();case 20:return e.next=22,t.scrollUp();case 22:case"end":return e.stop()}},e)})));case 13:return e.next=15,t.scrollDown();case 15:return t.scrollToNow(t.fillerHeight/2),t.scrollTo(t.fillerHeight/2,1200),e.next=19,t.scrollDown();case 19:return t.scrollToNow(t.fillerHeight/2),e.next=22,t.scrollUp();case 22:case"end":return e.stop()}},e)})))}}]),t}(),rt=console.log;function nt(){return it.apply(this,arguments)}function it(){return(it=o(f().mark(function t(){var e,r,n;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=function(){rt("%c ☆ Тест завершен! ☆ ",Z);var t=Array.from(this.testResults.errors).reduce(function(t,e){return t+e[1].length},0);0!==this.testResults.errors.size?(rt("%c Тестов не пройдено: ".concat(this.testResults.errors.size," <----"),"background-color: yellow; color: #333; font-weight: bold;"),rt("%c Ошибок обнаружено: ".concat(t," <----"),tt),this.testResults.errors.forEach(function(t,e){var r=t;rt("%c Тест: ".concat(e),tt),r.forEach(function(t,e){rt(e+1,t)})})):rt("%c ☆☆☆☆☆ Все тесты завершены без ошибок! Поздравляю! ☆☆☆☆☆",X)},this.testResults.errors.clear(),this.testResults.listName="".concat(this.testResults.listName," (").concat(this.vsb.deviceType," - ").concat(this.vsb.browserName,")"),e=new et({context:this}),n=!0,t.next=9,e.run.fastUpDownScrollDomTest(1,n);case 9:return t.next=11,e.run.chaoticScrollDomTest(1,n);case 11:return t.next=13,e.run.asyncChaoticScrollDomTest(1,n);case 13:return t.next=15,e.run.smoothUpDownScrollDomTest(1,n);case 15:return t.next=17,e.run.testLocalSimple100item(1,n);case 17:return t.next=19,e.run.testRemoteLazyDummyjsonAPI(1,n);case 19:return t.next=22,e.run.testRemoteSimple500item(1);case 22:return r.call(this),t.abrupt("return",Promise.resolve(this.testResults));case 24:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}var st={list:"UL",table:"TABLE",div:"DIV"},at={en:{error:{cantFetchData:"Failed to load data from server. Please check server availability or try again later",zeroHeight:"Your list height is less than 10px. You need to set your list-height from STYLES (by css) or pass like property in JS",elementNotExist:"This element does not exist in DOM",undefinedProps:"Some of props for RenderController is undefined",domManagerIsUndefined:"Your DomManager is undefined",renderControllerIsUndefined:"RenderController (this.render) is not exist",dataIsUndefined:"You does not have list.data",notValidUrl:"Your dataUrl is not a valid URL; or returned value is not a valid URL",notArray:"Your list does not have Array type",zeroListSize:"Your list does not have length or length is 0",noTargetElem:"You do not have HTML-element for your list",noDataUrl:"You dont have dataUrl",dataUrlNotAFn:"Your dataUrl is a string type",fetchedIsNotArray:"Your fetched data does not have Array type"},message:{localMode:"Failed to load data from server. \nUsing previously saved data",tryLoadData:"Try to load data again",noCacheMode:"Data caching is not supported"}},ru:{error:{cantFetchData:"Не удалось загрузить данные с сервера. Проверьте доступность сервера или попробуйте позже",zeroHeight:"Высота вашего списка меньше чем 10px. Вам нужно установить высоту вашего списка из СТИЛЕЙ (через CSS) или передавать как свойство в JS",elementNotExist:"Такого элемента не существует в DOM",undefinedProps:"Некоторые свойства для RenderController не определены",domManagerIsUndefined:"Ваш DomManager не определён",renderControllerIsUndefined:"RenderController (this.render) не существует",dataIsUndefined:"У вас отсутствует list.data",notValidUrl:"Ваш dataUrl не является правильной URL-ссылкой или возвращает неправильную ссылку (исправьте dataUrl в свойствах при запуске InfinityScroll)",notArray:"Ваш список не является массивом (Array). Проверьте, что вы передаёте внутрь InfinityScroll",zeroListSize:"Ваш список пуст или его размер равен 0",noTargetElem:"Вы не указали HTML-элемент для вашего списка",noDataUrl:"У вас нет dataUrl (ссылки)",dataUrlNotAFn:"Ваш dataUrl является строкой",fetchedIsNotArray:"Ваши загруженные данные не являются Массивом (Array)"},message:{localMode:"Не удалось загрузить данные с сервера. \nИспользуются ранее сохранённые данные",tryLoadData:"Попробовать загрузить данные ещё раз",noCacheMode:"Кэширование данных не поддерживается"}}}["ru"===navigator.language.split("-")[0]?"ru":"en"],ot=function(){function t(e){var r=this;c(this,t),h(this,"timerIdRefreshList",void 0),h(this,"name",void 0),h(this,"selectorId",void 0),h(this,"wrapperEl",void 0),h(this,"middleWrapper",void 0),h(this,"subDir",void 0),h(this,"forcedListLength",void 0),h(this,"listType",void 0),h(this,"tHeadNames",void 0),h(this,"listWrapperHeight",void 0),h(this,"dataLoadPlace",void 0),h(this,"isLazy",void 0),h(this,"dataUrl",void 0),h(this,"includeEnd",void 0),h(this,"basedIndex",void 0),h(this,"isSyncing",void 0),h(this,"listEl",void 0),h(this,"onChangeStatus",void 0),h(this,"offsetElem",void 0),h(this,"domMngr",void 0),h(this,"scroll",void 0),h(this,"chunk",void 0),h(this,"list",void 0),h(this,"render",void 0),h(this,"skeleton",void 0),h(this,"vsb",void 0),h(this,"dbmanager",void 0),h(this,"isDebugMode",!1),h(this,"test",void 0),h(this,"testResults",void 0),h(this,"status",void 0),h(this,"sleep",function(t){return new Promise(function(e){return setTimeout(e,t)})}),this.selectorId=e.selectorId;var n=document.getElementById(e.selectorId);null===n&&this.throwError("".concat(e.selectorId," - ").concat(at.error.elementNotExist)),this.wrapperEl=n,this.subDir=e.subDir,this.forcedListLength=e.forcedListLength,this.listType=e.listType||"list",this.tHeadNames=e.tHeadNames,this.listWrapperHeight=e.listWrapperHeight,this.isDebugMode=e.isDebugMode||!1,this.listEl=this.createInnerList(),this.onChangeStatus=function(t){r.middleWrapper.dataset.status=t},this.status=new $(this.onChangeStatus),this.scroll=new g,this.chunk=new m,this.list=new v,this.vsb=new q(this.isDebugMode,function(){r.isSyncing||(r.vsb.isSyncing=!0,r.scroll.setScrollDirection(r.vsb.elem.scrollTop,r.vsb.isPageChanged,r.vsb.isLastPage),r.vsb.handleScroll(),r.calcCurrentDOMRender(),requestAnimationFrame(function(){requestAnimationFrame(function(){r.vsb.scroll!==r.vsb.elem.scrollTop&&r.vsb.handleScroll(),r.vsb.isSyncing=!1})}))}),this.skeleton=new G({template:e.templateString,templateCb:e.templateCb,listType:this.listType});var i={skeleton:this.skeleton,targetElem:this.listEl};this.domMngr=new B(i),this.dataLoadPlace=Array.isArray(e.data)?"local":"remote",this.isLazy=!1,this.includeEnd=!1,this.basedIndex=1,this.isSyncing=!1,this.test=nt,this.testResults={listName:e.selectorId,currentTestName:"",errors:new Map},this.init(e)}var e,r,n,a,l,d,k,S,T,P,I,D,O,R,N,H,M,C;return u(t,[{key:"showHint",value:function(t,e){var r,n=j({className:"warningHint",text:t}),i=j({tagName:"button",className:"warningHint__Btn",text:"OK!"});i.addEventListener("click",function(t){t.stopPropagation(),n.classList.add("collapsed"),n.textContent="",i.remove(),e?e(n):n.remove()}),n.append(i),null===(r=this.wrapperEl)||void 0===r||r.prepend(n)}},{key:"showLocalModeHint",value:function(){var t=this;this.showHint(at.message.localMode,function(e){e.addEventListener("click",o(f().mark(function r(){var n;return f().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return W(e,"active"),r.prev=2,t.dataUrl||t.throwError(at.error.noDataUrl),r.next=6,t.getInitialListData(t.dataUrl);case 6:if(!(n=r.sent)){r.next=17;break}if(e.classList.remove("errorFetch"),W(e,"successFetch"),t.setInitialListData(n),!t.isLazy){r.next=15;break}return r.next=15,t.setInitialLazyRemoteData();case 15:t.domMngr.resetAllList(t.chunk,0,0,t.list,t.scroll.direction,t.vsb),setTimeout(function(){return e.remove()},2e3);case 17:r.next=23;break;case 19:r.prev=19,r.t0=r.catch(2),e.classList.remove("successFetch"),W(e,"errorFetch");case 23:case"end":return r.stop()}},r,null,[[2,19]])})))})}},{key:"throwError",value:function(t){throw this.status.setStatus(K.Error),this.middleWrapper.dataset.error=t,new Error(t)}},{key:"init",value:(C=o(f().mark(function t(e){var r=this;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.injectStyles(),"remote"!==this.dataLoadPlace){t.next=9;break}return this.dataUrl=e.data,t.next=5,J.build(this.selectorId);case 5:return this.dbmanager=t.sent,this.dbmanager||this.showHint(at.message.noCacheMode),t.next=9,this.setIndexedDb();case 9:Promise.allSettled([this.getSavedListData(),this.getInitialListData(e.data)]).then(function(){var t=o(f().mark(function t(n){var i,a,o,c;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=s(n,2),a=i[0],"rejected"===(o=i[1]).status&&"rejected"===a.status&&r.throwError(at.error.cantFetchData),c={isFromCache:!1,value:[]},"fulfilled"===o.status?c.value=o.value:"fulfilled"===a.status&&a.value.length&&(r.showLocalModeHint(),c.isFromCache=!0,c.value=a.value),r.setInitialListData(c.value),t.next=8,r.setListFullLength(c,e.data);case 8:r.setListLength(),r.start();case 10:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 10:case"end":return t.stop()}},t,this)})),function(t){return C.apply(this,arguments)})},{key:"start",value:(M=o(f().mark(function t(){var e,r,n,i=this;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.setDefaultStyles(),this.getAllSizes(),this.offsetElem=j({className:"offsetElem"}),this.middleWrapper.prepend(this.offsetElem),this.domMngr.offsetElem=this.offsetElem,!this.isLazy){t.next=9;break}return t.next=9,this.setInitialLazyRemoteData();case 9:this.vsb.setHeight=function(){return i.domMngr.setHeightToList(i.list)},this.chunk.lastPageLastRenderIndex=this.list.lastPageLength>this.list.halfOfExistingSizeInDOM?this.list.lastPageLength-this.list.halfOfExistingSizeInDOM:1,x(n={lastRenderIndex:this.chunk.lastRenderIndex,lastPageLastRenderIndex:this.chunk.lastPageLastRenderIndex,listLength:this.list.length,listlastPageLength:this.list.lastPageLength,chunkAmount:this.chunk.amount})&&this.throwError(at.error.undefinedProps),this.render=new p(n),this.domMngr.fillList(this.list),this.domMngr.setHeightToList(this.list),this.scroll.maxScroll=this.list.length*this.list.itemHeight-(null===(e=this.middleWrapper)||void 0===e?void 0:e.clientHeight),this.scroll.lastPageMaxScroll=this.list.lastPageLength*this.list.itemHeight-(null===(r=this.middleWrapper)||void 0===r?void 0:r.clientHeight),this.createVirtualScroll(),this.middleWrapper.addEventListener("scroll",function(t){if(!i.vsb.isSyncing){var e=i.middleWrapper;if(i.isSyncing=!0,i.scroll.setScrollDirection(i.middleWrapper.scrollTop,i.vsb.isPageChanged,i.vsb.isLastPage),i.vsb.setScrollFromOuterSrc(e.scrollTop,i.scroll.direction),i.vsb.isPageChanged){var r=s(i.calcRenderIndex(e.scrollTop),1)[0];i.chunk.setRenderIndex(r,i.vsb.currentPage,i.list.length,i.vsb.isLastPage),i.vsb.isLastPage,i.vsb.currentPage,i.refreshList()}else i.calcCurrentDOMRender();requestAnimationFrame(function(){requestAnimationFrame(function(){i.vsb.isPageChanged=!1,i.isSyncing=!1})})}}),this.setIndexedDb(),this.status.setStatus(K.Ready),this.middleWrapper.classList.add("hiddingStatus"),setTimeout(function(){i.middleWrapper.classList.remove("hiddingStatus","showStatus")},2e3);case 25:case"end":return t.stop()}},t,this)})),function(){return M.apply(this,arguments)})},{key:"setDefaultStyles",value:function(){if(void 0!==this.listWrapperHeight&&(this.wrapperEl.style.height=this.listWrapperHeight),this.wrapperEl.offsetHeight<10){var t=at.error.zeroHeight;this.wrapperEl.innerHTML="<h3>".concat(t,"</h3>"),this.throwError(t)}this.wrapperEl.style.position="relative"}},{key:"createInnerList",value:function(){this.middleWrapper=j({className:["middleWrapper","showStatus"]}),this.middleWrapper.dataset.status=K.Initial,this.wrapperEl.append(this.middleWrapper);var t=document.createElement(st[this.listType]),e="".concat(this.selectorId,"_").concat(this.listType.charAt(0).toUpperCase()).concat(this.listType.slice(1));if(t.setAttribute("class",e),"table"===this.listType&&this.tHeadNames&&this.tHeadNames.length>0){var r,n=document.createElement("tbody"),i=document.createElement("thead"),s=null===(r=this.tHeadNames)||void 0===r?void 0:r.reduce(function(t,e){return t+"<td>".concat(e,"</td>")},"");return i.innerHTML='<tr class="'.concat(this.selectorId,'__listItem">').concat(s,"</tr>"),this.middleWrapper.appendChild(t).appendChild(i),this.middleWrapper.appendChild(t).appendChild(n)}return this.middleWrapper.appendChild(t)}},{key:"getAllSizes",value:function(){void 0===this.domMngr&&this.throwError(at.error.domManagerIsUndefined),this.calculateWrapperDimensions();var t=this.ensureListItemExists();t.style.whiteSpace="nowrap",this.list.itemHeight=(null==t?void 0:t.offsetHeight)||this.list.wrapperHeight,this.initializeBaseStyles(),this.chunk.amount=Math.ceil(this.list.wrapperHeight/this.list.itemHeight),this.list.setExistingSizeInDOM(this.chunk.amount),this.list.halfOfExistingSizeInDOM=Math.ceil(this.list.existingSizeInDOM/2),this.chunk.htmlHeight=this.chunk.amount*this.list.itemHeight,this.calculateListProperties(),this.calculateLastPageProperties(),this.calculateIndexProperties(),this.cleanupTemporaryItem(t)}},{key:"calculateWrapperDimensions",value:function(){var t=window.getComputedStyle(this.wrapperEl);this.list.wrapperHeight=parseInt(t.getPropertyValue("height"),10)||1,this.list.wrapperHeight<2&&console.error("You must set height to your list-wrapper more than 10px!")}},{key:"ensureListItemExists",value:function(){var t=this.listEl.firstChild;if(!t){this.list.data||this.throwError(at.error.dataIsUndefined);var e=this.list.data[0];this.domMngr.targetElem.append(this.domMngr.createItem(e,0)),t=this.listEl.firstChild}return t}},{key:"calculateListProperties",value:function(){this.list.length=Math.round(this.vsb.safeLimit/this.list.itemHeight),this.list.length>this.list.fullLength&&(this.list.length=this.list.fullLength),(!this.isLazy&&this.list.length>this.list.data.length||this.list.length<=0)&&(this.list.length=this.list.data.length)}},{key:"calculateLastPageProperties",value:function(){this.list.lastPageLength=this.list.fullLength%this.list.length,0===this.list.lastPageLength&&(this.list.lastPageLength,this.list.lastPageLength=this.list.length)}},{key:"calculateIndexProperties",value:function(){this.chunk.lastRenderIndex=this.list.length-this.list.halfOfExistingSizeInDOM-this.list.tailingElementsAmount,this.list.startIndexOfLastPart=this.list.length-this.list.existingSizeInDOM,this.chunk.lastOrderNumber=Math.floor(this.list.length/this.chunk.amount)}},{key:"cleanupTemporaryItem",value:function(t){t&&this.domMngr.removeItem("firstChild")}},{key:"initializeBaseStyles",value:function(){var t="".concat(this.selectorId,"_").concat(this.listType.charAt(0).toUpperCase()).concat(this.listType.slice(1)),e={list:"li",table:"tbody > tr",div:"div"}[this.listType],r="\n    .".concat(this.selectorId,"_List {\n      overflow: hidden; \n      margin: 0;\n    }\n    \n    .").concat(this.selectorId,"_List li { \n      white-space: nowrap;\n    }\n    \n    .").concat(t," > ").concat(e).concat(".loading .dots {\n    width: 0.5em;\n    animation: load 3s steps(4, end) infinite;\n    display: inline-block;\n    overflow: hidden;\n    vertical-align: text-bottom;\n}\n\n@keyframes load {\n    from {\n        width: 0em;\n    }\n    to   {\n        width: 2em;\n    }\n}\n","\n    \n    .").concat(this.selectorId,"_List li.loading { \n      min-height: ").concat(this.list.itemHeight,"px;\n      box-sizing: border-box;\n    }\n    \n    .").concat(this.selectorId,"_List li.loading img { \n      width: 100%;\n      aspect-ratio: 1;\n      background: #ccc;\n      animation: opacityLoader 3s ease-in-out infinite alternate;\n      border-radius: 10px;\n    }\n    \n    @keyframes opacityLoader {\n      from { opacity: 1; }\n      to { opacity: 0.1; }\n    }\n  "),n=document.createElement("style");n.textContent=r.trim(),this.wrapperEl.prepend(n)}},{key:"createVirtualScroll",value:function(){var t;this.list.tailingElementsAmount=this.list.length%this.chunk.amount,this.list.pageTailingElementsAmount=this.list.length%this.chunk.amount,this.list.lastPageTailingElementsAmount=this.list.lastPageLength%this.chunk.amount,this.list.tailingElementsAmount,this.chunk.prevPageRenderIndex=this.chunk.lastRenderIndex+this.chunk.amount-this.chunk.lastRenderIndex%this.chunk.amount,this.render&&this.render.reInitValues(this.chunk.lastRenderIndex,this.list.length),this.domMngr.setHeightToList(this.list),this.skeleton.setListLength(this.list.fullLength),this.list.lastPageStartIndexOfLastPart=this.list.lastPageLength-this.list.existingSizeInDOM,this.list.lastPageStartIndexOfLastPart<0&&(this.list.lastPageStartIndexOfLastPart=0),this.chunk.lastOrderNumber=Math.floor(this.list.length/this.chunk.amount),this.chunk.lastPageLastOrderNumber=Math.floor(this.list.lastPageLength/this.chunk.amount);var e=this.list.getTotalListHeight(),r=this.listEl.offsetHeight;null===(t=this.middleWrapper)||void 0===t||t.after(this.vsb.elem),this.vsb.init({totalHeight:e,realHeight:r,fullLength:this.list.fullLength,listLength:this.list.length,lastPageLength:this.list.lastPageLength,origScrollElem:this.middleWrapper})}},{key:"calcRenderIndex",value:function(t){var e=this.chunk.getOrderNumber(t);var r=this.chunk.calcRenderIndex(e),n=this.vsb.isLastPage?this.chunk.lastPageLastOrderNumber:this.chunk.lastOrderNumber,i=this.vsb.isLastPage?this.scroll.lastPageMaxScroll:this.scroll.maxScroll;this.scroll.setGoingFromBottom(this.chunk.firstOrderNumber,n,e,t,i);var s=this.vsb.isLastPage?this.list.lastPageTailingElementsAmount:this.list.pageTailingElementsAmount,a=r+(this.scroll.isGoingFromBottom?s:0);return this.chunk.startRenderIndex!==a&&"up"===this.scroll.direction&&a>this.chunk.prevPageRenderIndex&&(a=this.list.length-3*this.chunk.amount),[a,r]}},{key:"calcCurrentDOMRender",value:(H=o(f().mark(function t(){var e,r,n,i,a,o,c,l;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.middleWrapper.scrollTop,r=this.calcRenderIndex(e),n=s(r,2),i=n[0],n[1],a=this.list.length*(this.vsb.currentPage-1)+i,o=this.chunk.getRenderIndexDiff(a),((c=this.checkBigDiff(o))||this.vsb.isPageChanged)&&(clearTimeout(this.timerIdRefreshList),this.setTimerToRefreshList()),this.chunk.startRenderIndex===i){t.next=11;break}return l=this.chunk.startRenderIndex,this.chunk.setRenderIndex(i,this.vsb.currentPage,this.list.length,this.vsb.isLastPage),t.next=11,this.updateCurrentDOM(o,l,c);case 11:case"end":return t.stop()}},t,this)})),function(){return H.apply(this,arguments)})},{key:"updateCurrentDOM",value:(N=o(f().mark(function t(e,r,n){var i,a,o,c,l,u;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.render||this.throwError(at.error.renderControllerIsUndefined),!this.render.isAllowRenderNearBorder(this.scroll.direction,this.chunk.startRenderIndex,1!==this.vsb.currentPage&&this.vsb.isLastPage)||!this.domMngr){t.next=12;break}if(i=this.determineScrollDirection(r),this.fixScrollDirection(i),a={itemIndex:this.chunk.itemIndex,startRenderIndex:this.chunk.startRenderIndex,amount:this.chunk.amount,htmlHeight:this.chunk.htmlHeight},!this.isLazy||n){t.next=10;break}return o=this.getSequence(this.chunk.itemIndex),c=s(o,2),l=c[0],u=c[1],t.next=10,this.loadDataFromSources(l,u);case 10:this.domMngr.modifyCurrentDOM(a,this.list,this.scroll.direction,this.scroll.isGoingFromBottom,this.vsb),n||this.checkIndexOrdering(this.scroll.isGoingFromBottom);case 12:case"end":return t.stop()}},t,this)})),function(t,e,r){return N.apply(this,arguments)})},{key:"determineScrollDirection",value:function(t){if(!this.timerIdRefreshList)return this.chunk.startRenderIndex<t?"up":"down"}},{key:"fixScrollDirection",value:function(t){t&&t!==this.scroll.direction&&(console.warn("================ Направления не совпадают!"),this.scroll.direction=t)}},{key:"checkBigDiff",value:function(t){var e=this.vsb.isLastPage?this.list.lastPageTailingElementsAmount:this.list.pageTailingElementsAmount;return this.scroll.isBigDiff(t,this.chunk.amount,e)}},{key:"loadDataFromSources",value:(R=o(f().mark(function t(e,r){var n,i,s=this;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=[{name:"DB",loader:function(){var t=o(f().mark(function t(){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.getItemsFromDB(e,r);case 2:return t.abrupt("return",s.checkItemForLoad(e,r));case 3:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()},{name:"fetch",loader:function(){var t=o(f().mark(function t(e){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s.fetchUnfoundedRanges(e),t.abrupt("return",[]);case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}],i=this.checkItemForLoad(e,r),t.next=4,n.reduce(function(){var t=o(f().mark(function t(e,r){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:if(0!==i.length){t.next=4;break}return t.abrupt("return",Promise.resolve());case 4:return"Unfounded (for ".concat(r.name,")"),t.next=7,r.loader(i);case 7:return i=t.sent,t.abrupt("return",Promise.resolve());case 9:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}(),Promise.resolve());case 4:case"end":return t.stop()}},t,this)})),function(t,e){return R.apply(this,arguments)})},{key:"refreshList",value:function(t){if(this.render){var e=this.chunk.startRenderIndex;this.chunk.setRenderIndex(e,this.vsb.currentPage,this.list.length,this.vsb.isLastPage),this.vsb.currentPage!==this.vsb.totalPages||this.vsb.isLastPage||console.error(this.vsb.currentPage,this.vsb.currentPage===this.vsb.totalPages,this.vsb.isLastPage);var r=s(this.getSequence(this.chunk.itemIndex,!0,this.vsb.isLastPage),2),n=r[0],i=r[1];if(this.isLazy){var a=[n,i];this.fetchUnfoundedRanges([a])}t&&t!==this.timerIdRefreshList||(this.domMngr.resetAllList(this.chunk,e,n,this.list,this.scroll.direction,this.vsb),this.timerIdRefreshList=void 0,this.checkIndexOrdering(this.scroll.isGoingFromBottom))}}},{key:"setTimerToRefreshList",value:function(){var t=this,e=window.setTimeout(o(f().mark(function r(){return f().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t.refreshList(e);case 1:case"end":return r.stop()}},r)})),0);this.timerIdRefreshList=e}},{key:"setApiSettings",value:(O=o(f().mark(function t(){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w(this.dataUrl,this.subDir);case 2:return this.includeEnd=t.sent,t.next=5,L(this.dataUrl,this.includeEnd,this.subDir);case 5:this.basedIndex=t.sent;case 6:case"end":return t.stop()}},t,this)})),function(){return O.apply(this,arguments)})},{key:"setListData",value:function(t){var e=this;t.forEach(function(t,r){return e.setListDataByIndex(t,r)}),this.saveListData(t)}},{key:"saveListData",value:function(t){if(this.dbmanager){var e=this.list.data.map(function(t,e){return{index:e,value:t}});this.dbmanager.writeMany(e)}}},{key:"setListDataByIndex",value:function(t,e){this.list.data[e]=t}},{key:"saveListDataByIndex",value:function(t,e){this.dbmanager&&this.dbmanager.write(e,t)}},{key:"getSavedListData",value:(D=o(f().mark(function t(){var e,r,n,i;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.dbmanager){t.next=2;break}return t.abrupt("return",Promise.reject());case 2:return t.next=4,this.dbmanager.getStoreSize();case 4:if(e=t.sent,r=5e5,n=this.isLazy?r:e,!(e<=n)){t.next=13;break}return t.next=10,this.dbmanager.readAll();case 10:i=t.sent,t.next=17;break;case 13:return console.warn("Объем закешированных данных слишком большой"),t.next=16,this.dbmanager.readRange(0,r-1);case 16:i=t.sent;case 17:return t.abrupt("return",i);case 18:case"end":return t.stop()}},t,this)})),function(){return D.apply(this,arguments)})},{key:"getInitialListData",value:(I=o(f().mark(function t(e){var r;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!Array.isArray(e)){t.next=3;break}return t.abrupt("return",e);case 3:return this.status.setStatus(K.Loading),t.next=6,this.setRemoteDataSettings(e);case 6:return t.next=8,this.getInitialRemoteData(e);case 8:return r=t.sent,t.abrupt("return",r);case 10:case"end":return t.stop()}},t,this)})),function(t){return I.apply(this,arguments)})},{key:"setInitialListData",value:function(t){"local"===this.dataLoadPlace?this.setLocalData(t):this.setListData(t)}},{key:"setLocalData",value:function(t){this.list.data=t}},{key:"setRemoteDataSettings",value:(P=o(f().mark(function t(e){var r,n,i,a;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=E(e),n=s(r,2),i=n[0],a=n[1],i||a||this.throwError(at.error.notValidUrl),!a){t.next=6;break}return this.isLazy=!0,t.next=6,this.setApiSettings();case 6:case"end":return t.stop()}},t,this)})),function(t){return P.apply(this,arguments)})},{key:"getInitialRemoteData",value:(T=o(f().mark(function t(e){var r,n,i;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isLazy){t.next=4;break}return r=this.basedIndex,n=this.basedIndex+Number(!this.includeEnd),t.abrupt("return",this.getListDataLazy(r,n));case 4:return t.next=6,y(e);case 6:return i=t.sent,t.abrupt("return",this.extractResponse(i));case 8:case"end":return t.stop()}},t,this)})),function(t){return T.apply(this,arguments)})},{key:"setInitialLazyRemoteData",value:(S=o(f().mark(function t(){var e,r,n;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.basedIndex+1,t.next=3,this.getListDataLazy(e,this.list.existingSizeInDOM);case 3:r=t.sent,n=new Array(1).concat(r),this.setListData(n);case 6:case"end":return t.stop()}},t,this)})),function(){return S.apply(this,arguments)})},{key:"setListFullLength",value:(k=o(f().mark(function t(e,r){var n;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=function(t){return"function"==typeof t},!this.forcedListLength){t.next=5;break}this.list.fullLength=this.forcedListLength,t.next=12;break;case 5:if(!n(r)||e.isFromCache){t.next=10;break}return t.next=8,this.setListFullLengthFromUrl(r);case 8:t.next=12;break;case 10:return t.next=12,this.setListFullLengthFromData(e);case 12:case"end":return t.stop()}},t,this)})),function(t,e){return k.apply(this,arguments)})},{key:"setListFullLengthFromData",value:(d=o(f().mark(function t(e){var r;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.value,!e.isFromCache){t.next=10;break}return t.next=4,this.defineCachedDataLastIndex();case 4:if(t.t0=t.sent,t.t0){t.next=7;break}t.t0=r.length;case 7:this.list.fullLength=t.t0,t.next=11;break;case 10:this.list.fullLength=r.length;case 11:case"end":return t.stop()}},t,this)})),function(t){return d.apply(this,arguments)})},{key:"defineCachedDataLastIndex",value:(l=o(f().mark(function t(){var e,r;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.dbmanager){t.next=2;break}return t.abrupt("return",Promise.reject());case 2:return t.next=4,this.dbmanager.getLastKey();case 4:return e=t.sent,r="number"==typeof e?e+1:void 0,t.abrupt("return",r);case 8:case"end":return t.stop()}},t,this)})),function(){return l.apply(this,arguments)})},{key:"setListFullLengthFromUrl",value:(a=o(f().mark(function t(e){var r;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A(e,this.subDir);case 2:t.t0=t.sent,t.t1=Number(!this.basedIndex),r=t.t0+t.t1,this.list.fullLength=r;case 6:case"end":return t.stop()}},t,this)})),function(t){return a.apply(this,arguments)})},{key:"setListLength",value:function(){Array.isArray(this.list.data)||this.throwError(at.error.notArray),this.list.fullLength||this.throwError(at.error.zeroListSize),this.list.length=this.list.fullLength,this.skeleton.setListLength(this.list.length)}},{key:"getSequence",value:function(t){var e,r,n,i,s,a,o,c,l=arguments.length>1&&void 0!==arguments[1]&&arguments[1],u=arguments.length>2&&void 0!==arguments[2]&&arguments[2];u?n=this.list.length*(this.vsb.totalPages-1)+this.list.lastPageLength:n=this.list.length*this.vsb.currentPage;if(l){var h,d=t-this.chunk.amount,f=this.list.length*(this.vsb.currentPage-1);if(u){var p=this.list.length*(this.vsb.totalPages-1),g=this.list.lastPageLength-this.list.existingSizeInDOM;g<0&&(g=0),h=p+g}else h=this.list.length*this.vsb.currentPage-this.list.existingSizeInDOM;(e=d>f?d:f)>h&&(e=h),r=e+this.list.existingSizeInDOM}else i=this.scroll.direction,s=this.list.halfOfExistingSizeInDOM,a=t,o=this.chunk.amount,(c="down"===i?a+s:a-o)<0&&(c=0),(r=(e=c)+this.chunk.amount)>n&&(r=n);return[e,r]}},{key:"fetchUnfoundedRanges",value:function(t){var e=this;t.forEach(function(t){var r=s(t,2),n=r[0],i=r[1],a=n+e.basedIndex,o=i+e.basedIndex-Number(e.includeEnd);b(e.dataUrl,a,o).then(function(t){if(0!==t.length){var r=e.extractResponse(t);e.addNewItemsToDataList(n,r),e.updateSkeletonItems(n,r)}})})}},{key:"addNewItemsToDataList",value:function(t,e){for(var r=e.length,n=0;n<r;n++){var i=t+n;this.setListDataByIndex(e[n],i),this.saveListDataByIndex(e[n],i)}}},{key:"updateSkeletonItems",value:function(t,e){for(var r=e.length,n=0;n<r;n++){var i=t+n+1,s='[aria-posinset="'.concat(i,'"]'),a=this.domMngr.targetElem.querySelector(s);a&&this.skeleton.updateElement(a,e[n],i)}}},{key:"getItemsFromDB",value:(n=o(f().mark(function t(e,r){var n,s;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.dbmanager){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.dbmanager.readRange(e,r-1);case 4:s=t.sent,(n=this.list.data).splice.apply(n,[e,this.chunk.amount].concat(i(s)));case 7:case"end":return t.stop()}},t,this)})),function(t,e){return n.apply(this,arguments)})},{key:"checkItemForLoad",value:function(t,e){for(var r=[],n=!1,i=[],s=e-1,a=t;a<e;a++){var o=this.list.data[a];if(void 0===o&&!1===n)n=!0,i.push(a);else if(n&&(void 0!==o||a===s)){var c=a===s&&void 0===o?a+1:a;i.push(c),r.push(i.slice()),i.length=0,n=!1}}return r}},{key:"checkIndexOrdering",value:function(t){var e,r=this,n=null===(e=this.domMngr)||void 0===e?void 0:e.targetElem;n||this.throwError(at.error.noTargetElem);var s=null,a=!0;return i(n.children).forEach(function(e){var n=Number(e.getAttribute("aria-posinset"));if(null!==s){if(s+1!==n){var i="Индексы поломались на элементе ".concat(n," (ожидали ").concat(s+1,"), isGoingFromBottom - ").concat(t);console.error("".concat(r.testResults.currentTestName," -- ").concat(i,")"));var o=r.testResults.errors.get(r.testResults.currentTestName);Array.isArray(o)||(o=[],r.testResults.errors.set(r.testResults.currentTestName,o)),o.push(i),a=!1}s=n}else s=n}),a}},{key:"getListDataLazy",value:(r=o(f().mark(function t(){var e,r,n,i=arguments;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:0,r=i.length>1&&void 0!==i[1]?i[1]:1,this.dataUrl||this.throwError(at.error.noDataUrl),"string"==typeof this.dataUrl&&this.throwError(at.error.dataUrlNotAFn),t.prev=4,t.next=7,b(this.dataUrl,e,r);case 7:return n=t.sent,t.abrupt("return",this.extractResponse(n));case 11:return t.prev=11,t.t0=t.catch(4),t.abrupt("return",[]);case 14:case"end":return t.stop()}},t,this,[[4,11]])})),function(){return r.apply(this,arguments)})},{key:"extractResponse",value:function(t){var e=Array.isArray(t)?t:this.subDir&&t[this.subDir];return Array.isArray(e)||this.throwError(at.error.fetchedIsNotArray),e}},{key:"setIndexedDb",value:(e=o(f().mark(function t(){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.dbmanager){t.next=2;break}return t.abrupt("return");case 2:return t.next=8,this.dbmanager.setTTL(6048e5);case 8:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)})},{key:"injectStyles",value:function(){if(!document.querySelector("[data-infinity-scroll-styles]")){var t="".concat('.middleWrapper{position:relative;overflow-y:scroll;height:100%;-ms-overflow-style:none;scrollbar-width:none}.middleWrapper::-webkit-scrollbar{display:none}.middleWrapper.showStatus:before,.middleWrapper.showStatus:after{opacity:1;-webkit-transition:all 1.5s ease-in-out;transition:all 1.5s ease-in-out}.middleWrapper.showStatus:before{content:"";position:absolute;display:inline-block;width:30px;height:30px;border:4px dotted #333;border-radius:50%;-webkit-animation:spin 2s linear infinite;animation:spin 2s linear infinite;left:calc(50% - 15px);top:calc(50% - 140px);z-index:2}@media screen and (min-width: 768px){.middleWrapper.showStatus:before{top:calc(50% - 90px)}}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.middleWrapper.showStatus:after{content:"Initializing iScroll... \\a\\aStatus: " attr(data-status);text-align:center;position:absolute;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;top:0;left:0;white-space:pre;padding:0 15px;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;height:100%;-webkit-backdrop-filter:blur(50px);backdrop-filter:blur(50px)}@media screen and (min-width: 600px){.middleWrapper.showStatus:after{padding:0 80px}}@media screen and (min-width: 992px){.middleWrapper.showStatus:after{padding:0 150px}}.middleWrapper.showStatus[data-status=error]:after{content:"Error: \\a\\a" attr(data-error);background-color:rgba(255,0,0,.25);white-space:normal}.middleWrapper.hiddingStatus:before,.middleWrapper.hiddingStatus:after{-webkit-backdrop-filter:blur(0px);backdrop-filter:blur(0px);opacity:0}.warningHint{position:absolute;top:0;right:0;width:100%;height:100%;text-align:center;white-space:pre-line;line-height:140%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);z-index:3;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out}.warningHint.collapsed{width:30px;height:30px;cursor:pointer;right:30px}.warningHint.collapsed:before{content:"↺";font-size:20px;display:inline-block;-webkit-transition:text-shadow .6s ease-in-out;transition:text-shadow .6s ease-in-out}.warningHint.collapsed:hover:before{font-weight:bold}.warningHint.collapsed.active:before{-webkit-transition:all .6s ease-in-out;transition:all .6s ease-in-out;-webkit-transform:rotate(-360deg);transform:rotate(-360deg)}.warningHint.collapsed.errorFetch:before{text-shadow:0px 0px 5px red}.warningHint.collapsed.successFetch:before{text-shadow:0px 0px 5px green}.warningHint__Btn{margin:20px auto;display:inline-block;border:1px solid #333;background-color:#fff;padding:6px 20px;border-radius:5px;cursor:pointer}.warningHint__Btn:hover{background-color:#333;color:#fff}'," \n ").concat(".vSrcollbar{position:absolute;top:0;right:0;min-width:12px;height:100%;overflow-y:scroll;overflow-x:hidden;-webkit-overflow-scrolling:touch;background-color:rgba(0,0,0,0)}.vSrcollbar_debugMode{width:400px;-webkit-transform:translate(-16px, 0px);transform:translate(-16px, 0px);background-color:rgba(92,99,112,.2)}.vSrcollbar_googleChrome{min-width:16px}.vSrcollbar_mozillaFirefox{min-width:18px}.vSrcollbar_safari{min-width:16px}@media(pointer: coarse){.vSrcollbar{width:30px}.vSrcollbar::-webkit-scrollbar{width:16px}.vSrcollbar::-webkit-scrollbar-thumb{background:rgba(0,0,0,.4);min-height:60px;border-radius:10px}}.vScrollbarFiller{width:100%;min-width:1px}.mobileScrollbar-track{position:absolute;top:0;right:0;-webkit-transition:opacity .3s ease;transition:opacity .3s ease;z-index:9;height:100%;width:30px;background:#f1f1f1;opacity:.8}.mobileScrollbar-track:hover{opacity:.6}.mobileScrollbar-thumb{position:absolute;top:0;left:0;min-height:30px;width:100%;cursor:pointer;background:#888;border-radius:15px;-webkit-transition:background-color .2s ease;transition:background-color .2s ease}.mobileScrollbar-srcElem{overflow-y:scroll;overflow-x:hidden;-webkit-overflow-scrolling:touch;scrollbar-width:none;-ms-overflow-style:none;padding-right:17px;margin-right:-17px}.mobileScrollbar-srcElem::-webkit-scrollbar{display:none}"),e=document.createElement("style");e.setAttribute("data-infinity-scroll-styles","true"),e.textContent=t,document.head.appendChild(e)}}}]),t}()})(),self.InfinityScroll=n.InfinityScroll})();